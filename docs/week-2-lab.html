<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Week 2 Lab | Biometry Lecture and Lab Notes</title>
  <meta name="description" content="4 Week 2 Lab | Biometry Lecture and Lab Notes" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Week 2 Lab | Biometry Lecture and Lab Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Week 2 Lab | Biometry Lecture and Lab Notes" />
  
  
  

<meta name="author" content="Heather Lynch" />


<meta name="date" content="2024-01-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-2-lecture.html"/>
<link rel="next" href="week-3-lecture.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biometry Lecture and Lab Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface, data sets, and past exams</a></li>
<li class="chapter" data-level="1" data-path="week-1-lecture.html"><a href="week-1-lecture.html"><i class="fa fa-check"></i><b>1</b> Week 1 Lecture</a>
<ul>
<li class="chapter" data-level="1.1" data-path="week-1-lecture.html"><a href="week-1-lecture.html#week-1-readings"><i class="fa fa-check"></i><b>1.1</b> Week 1 Readings</a></li>
<li class="chapter" data-level="1.2" data-path="week-1-lecture.html"><a href="week-1-lecture.html#basic-outline"><i class="fa fa-check"></i><b>1.2</b> Basic Outline</a></li>
<li class="chapter" data-level="1.3" data-path="week-1-lecture.html"><a href="week-1-lecture.html#todays-agenda"><i class="fa fa-check"></i><b>1.3</b> Today’s Agenda</a></li>
<li class="chapter" data-level="1.4" data-path="week-1-lecture.html"><a href="week-1-lecture.html#basic-probability-theory"><i class="fa fa-check"></i><b>1.4</b> Basic Probability Theory</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="week-1-lecture.html"><a href="week-1-lecture.html#intersection"><i class="fa fa-check"></i><b>1.4.1</b> Intersection</a></li>
<li class="chapter" data-level="1.4.2" data-path="week-1-lecture.html"><a href="week-1-lecture.html#union"><i class="fa fa-check"></i><b>1.4.2</b> Union</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="week-1-lecture.html"><a href="week-1-lecture.html#multiple-events"><i class="fa fa-check"></i><b>1.5</b> Multiple events</a></li>
<li class="chapter" data-level="1.6" data-path="week-1-lecture.html"><a href="week-1-lecture.html#conditionals"><i class="fa fa-check"></i><b>1.6</b> Conditionals</a></li>
<li class="chapter" data-level="1.7" data-path="week-1-lecture.html"><a href="week-1-lecture.html#a-few-foundational-ideas"><i class="fa fa-check"></i><b>1.7</b> A few foundational ideas</a></li>
<li class="chapter" data-level="1.8" data-path="week-1-lecture.html"><a href="week-1-lecture.html#overview-of-univariate-distributions"><i class="fa fa-check"></i><b>1.8</b> Overview of Univariate Distributions</a></li>
<li class="chapter" data-level="1.9" data-path="week-1-lecture.html"><a href="week-1-lecture.html#what-can-you-ask-of-a-distribution"><i class="fa fa-check"></i><b>1.9</b> What can you ask of a distribution?</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="week-1-lecture.html"><a href="week-1-lecture.html#expected-value-of-a-random-variable"><i class="fa fa-check"></i><b>1.9.1</b> Expected Value of a Random Variable</a></li>
<li class="chapter" data-level="1.9.2" data-path="week-1-lecture.html"><a href="week-1-lecture.html#discrete-case"><i class="fa fa-check"></i><b>1.9.2</b> Discrete Case</a></li>
<li class="chapter" data-level="1.9.3" data-path="week-1-lecture.html"><a href="week-1-lecture.html#continuous-case"><i class="fa fa-check"></i><b>1.9.3</b> Continuous Case</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="week-1-lecture.html"><a href="week-1-lecture.html#a-brief-introduction-to-inference-logic-and-reasoning"><i class="fa fa-check"></i><b>1.10</b> A brief introduction to inference, logic, and reasoning</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="week-1-lab.html"><a href="week-1-lab.html"><i class="fa fa-check"></i><b>2</b> Week 1 Lab</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1-lab.html"><a href="week-1-lab.html#using-r-like-a-calculator"><i class="fa fa-check"></i><b>2.1</b> Using R like a calculator</a></li>
<li class="chapter" data-level="2.2" data-path="week-1-lab.html"><a href="week-1-lab.html#the-basic-data-structures-in-r"><i class="fa fa-check"></i><b>2.2</b> The basic data structures in R</a></li>
<li class="chapter" data-level="2.3" data-path="week-1-lab.html"><a href="week-1-lab.html#writing-functions-in-r"><i class="fa fa-check"></i><b>2.3</b> Writing functions in R</a></li>
<li class="chapter" data-level="2.4" data-path="week-1-lab.html"><a href="week-1-lab.html#writing-loops-and-ifelse"><i class="fa fa-check"></i><b>2.4</b> Writing loops and if/else</a></li>
<li class="chapter" data-level="2.5" data-path="week-1-lab.html"><a href="week-1-lab.html#pop_vs_sample_var"><i class="fa fa-check"></i><b>2.5</b> (A short diversion) Bias in estimators</a></li>
<li class="chapter" data-level="2.6" data-path="week-1-lab.html"><a href="week-1-lab.html#some-practice-writing-r-code"><i class="fa fa-check"></i><b>2.6</b> Some practice writing R code</a></li>
<li class="chapter" data-level="2.7" data-path="week-1-lab.html"><a href="week-1-lab.html#a-few-final-notes"><i class="fa fa-check"></i><b>2.7</b> A few final notes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-2-lecture.html"><a href="week-2-lecture.html"><i class="fa fa-check"></i><b>3</b> Week 2 Lecture</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-2-lecture.html"><a href="week-2-lecture.html#week-2-readings"><i class="fa fa-check"></i><b>3.1</b> Week 2 Readings</a></li>
<li class="chapter" data-level="3.2" data-path="week-2-lecture.html"><a href="week-2-lecture.html#todays-agenda-1"><i class="fa fa-check"></i><b>3.2</b> Today’s Agenda</a></li>
<li class="chapter" data-level="3.3" data-path="week-2-lecture.html"><a href="week-2-lecture.html#hypothesis-testing"><i class="fa fa-check"></i><b>3.3</b> Hypothesis testing</a></li>
<li class="chapter" data-level="3.4" data-path="week-2-lecture.html"><a href="week-2-lecture.html#permutation-tests"><i class="fa fa-check"></i><b>3.4</b> Permutation tests</a></li>
<li class="chapter" data-level="3.5" data-path="week-2-lecture.html"><a href="week-2-lecture.html#parameter-estimation"><i class="fa fa-check"></i><b>3.5</b> Parameter estimation</a></li>
<li class="chapter" data-level="3.6" data-path="week-2-lecture.html"><a href="week-2-lecture.html#method-1-non-parametric-bootstrap"><i class="fa fa-check"></i><b>3.6</b> Method #1: Non-parametric bootstrap</a></li>
<li class="chapter" data-level="3.7" data-path="week-2-lecture.html"><a href="week-2-lecture.html#parametric-bootstrap"><i class="fa fa-check"></i><b>3.7</b> Parametric bootstrap</a></li>
<li class="chapter" data-level="3.8" data-path="week-2-lecture.html"><a href="week-2-lecture.html#jackknife"><i class="fa fa-check"></i><b>3.8</b> Jackknife</a></li>
<li class="chapter" data-level="3.9" data-path="week-2-lecture.html"><a href="week-2-lecture.html#jackknife-after-bootstrap"><i class="fa fa-check"></i><b>3.9</b> Jackknife-after-bootstrap</a></li>
<li class="chapter" data-level="3.10" data-path="week-2-lecture.html"><a href="week-2-lecture.html#by-the-end-of-week-2-you-should-understand"><i class="fa fa-check"></i><b>3.10</b> By the end of Week 2, you should understand…</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-2-lab.html"><a href="week-2-lab.html"><i class="fa fa-check"></i><b>4</b> Week 2 Lab</a>
<ul>
<li class="chapter" data-level="4.1" data-path="week-2-lab.html"><a href="week-2-lab.html#confidence-intervals"><i class="fa fa-check"></i><b>4.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="4.2" data-path="week-2-lab.html"><a href="week-2-lab.html#testing-hypotheses-through-permutation"><i class="fa fa-check"></i><b>4.2</b> Testing hypotheses through permutation</a></li>
<li class="chapter" data-level="4.3" data-path="week-2-lab.html"><a href="week-2-lab.html#basics-of-bootstrap-and-jackknife"><i class="fa fa-check"></i><b>4.3</b> Basics of bootstrap and jackknife</a></li>
<li class="chapter" data-level="4.4" data-path="week-2-lab.html"><a href="week-2-lab.html#calculating-bias-and-standard-error"><i class="fa fa-check"></i><b>4.4</b> Calculating bias and standard error</a></li>
<li class="chapter" data-level="4.5" data-path="week-2-lab.html"><a href="week-2-lab.html#parametric-bootstrap-1"><i class="fa fa-check"></i><b>4.5</b> Parametric bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="week-3-lecture.html"><a href="week-3-lecture.html"><i class="fa fa-check"></i><b>5</b> Week 3 Lecture</a>
<ul>
<li class="chapter" data-level="5.1" data-path="week-3-lecture.html"><a href="week-3-lecture.html#week-3-readings"><i class="fa fa-check"></i><b>5.1</b> Week 3 Readings</a></li>
<li class="chapter" data-level="5.2" data-path="week-3-lecture.html"><a href="week-3-lecture.html#overview-of-probability-distributions"><i class="fa fa-check"></i><b>5.2</b> Overview of probability distributions</a></li>
<li class="chapter" data-level="5.3" data-path="week-3-lecture.html"><a href="week-3-lecture.html#normal-gaussian-distribution"><i class="fa fa-check"></i><b>5.3</b> Normal (Gaussian) Distribution</a></li>
<li class="chapter" data-level="5.4" data-path="week-3-lecture.html"><a href="week-3-lecture.html#standard-normal-distribution"><i class="fa fa-check"></i><b>5.4</b> Standard Normal Distribution</a></li>
<li class="chapter" data-level="5.5" data-path="week-3-lecture.html"><a href="week-3-lecture.html#log-normal-distribution"><i class="fa fa-check"></i><b>5.5</b> Log-Normal Distribution</a></li>
<li class="chapter" data-level="5.6" data-path="week-3-lecture.html"><a href="week-3-lecture.html#intermission-central-limit-theorem"><i class="fa fa-check"></i><b>5.6</b> Intermission: Central Limit Theorem</a></li>
<li class="chapter" data-level="5.7" data-path="week-3-lecture.html"><a href="week-3-lecture.html#poisson-distribution"><i class="fa fa-check"></i><b>5.7</b> Poisson Distribution</a></li>
<li class="chapter" data-level="5.8" data-path="week-3-lecture.html"><a href="week-3-lecture.html#binomial-distribution"><i class="fa fa-check"></i><b>5.8</b> Binomial Distribution</a></li>
<li class="chapter" data-level="5.9" data-path="week-3-lecture.html"><a href="week-3-lecture.html#beta-distribution"><i class="fa fa-check"></i><b>5.9</b> Beta Distribution</a></li>
<li class="chapter" data-level="5.10" data-path="week-3-lecture.html"><a href="week-3-lecture.html#gamma-distribution"><i class="fa fa-check"></i><b>5.10</b> Gamma Distribution</a></li>
<li class="chapter" data-level="5.11" data-path="week-3-lecture.html"><a href="week-3-lecture.html#some-additional-notes"><i class="fa fa-check"></i><b>5.11</b> Some additional notes:</a></li>
<li class="chapter" data-level="5.12" data-path="week-3-lecture.html"><a href="week-3-lecture.html#by-the-end-of-week-3-you-should-understand"><i class="fa fa-check"></i><b>5.12</b> By the end of Week 3, you should understand…</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="week-3-lab.html"><a href="week-3-lab.html"><i class="fa fa-check"></i><b>6</b> Week 3 Lab</a>
<ul>
<li class="chapter" data-level="6.1" data-path="week-3-lab.html"><a href="week-3-lab.html#exploring-the-univariate-distributions-with-r"><i class="fa fa-check"></i><b>6.1</b> Exploring the univariate distributions with R</a></li>
<li class="chapter" data-level="6.2" data-path="week-3-lab.html"><a href="week-3-lab.html#standard-deviation-vs.-standard-error"><i class="fa fa-check"></i><b>6.2</b> Standard deviation vs. Standard error</a></li>
<li class="chapter" data-level="6.3" data-path="week-3-lab.html"><a href="week-3-lab.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>6.3</b> The Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="week-4-lecture.html"><a href="week-4-lecture.html"><i class="fa fa-check"></i><b>7</b> Week 4 Lecture</a>
<ul>
<li class="chapter" data-level="7.1" data-path="week-4-lecture.html"><a href="week-4-lecture.html#week-4-readings"><i class="fa fa-check"></i><b>7.1</b> Week 4 Readings</a></li>
<li class="chapter" data-level="7.2" data-path="week-4-lecture.html"><a href="week-4-lecture.html#short-digression-degrees-of-freedom"><i class="fa fa-check"></i><b>7.2</b> Short digression: Degrees of freedom</a></li>
<li class="chapter" data-level="7.3" data-path="week-4-lecture.html"><a href="week-4-lecture.html#t-distribution"><i class="fa fa-check"></i><b>7.3</b> t-distribution</a></li>
<li class="chapter" data-level="7.4" data-path="week-4-lecture.html"><a href="week-4-lecture.html#chi-squared-distribution"><i class="fa fa-check"></i><b>7.4</b> Chi-squared distribution</a></li>
<li class="chapter" data-level="7.5" data-path="week-4-lecture.html"><a href="week-4-lecture.html#f-distribution"><i class="fa fa-check"></i><b>7.5</b> F distribution</a></li>
<li class="chapter" data-level="7.6" data-path="week-4-lecture.html"><a href="week-4-lecture.html#estimating-confidence-intervals---5-special-cases"><i class="fa fa-check"></i><b>7.6</b> Estimating confidence intervals - 5 special cases</a></li>
<li class="chapter" data-level="7.7" data-path="week-4-lecture.html"><a href="week-4-lecture.html#to-recap"><i class="fa fa-check"></i><b>7.7</b> To recap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="week-4-lab.html"><a href="week-4-lab.html"><i class="fa fa-check"></i><b>8</b> Week 4 Lab</a></li>
<li class="chapter" data-level="9" data-path="week-5-lecture.html"><a href="week-5-lecture.html"><i class="fa fa-check"></i><b>9</b> Week 5 Lecture</a>
<ul>
<li class="chapter" data-level="9.1" data-path="week-5-lecture.html"><a href="week-5-lecture.html#week-5-readings"><i class="fa fa-check"></i><b>9.1</b> Week 5 Readings</a></li>
<li class="chapter" data-level="9.2" data-path="week-5-lecture.html"><a href="week-5-lecture.html#statistical-power"><i class="fa fa-check"></i><b>9.2</b> Statistical power</a></li>
<li class="chapter" data-level="9.3" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-single-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> The single sample t test</a></li>
<li class="chapter" data-level="9.4" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-unpaired-two-sample-t-test"><i class="fa fa-check"></i><b>9.4</b> The unpaired two sample t test</a></li>
<li class="chapter" data-level="9.5" data-path="week-5-lecture.html"><a href="week-5-lecture.html#pooledvar"><i class="fa fa-check"></i><b>9.5</b> Pooling the variances</a></li>
<li class="chapter" data-level="9.6" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-paired-two-sample-t-test"><i class="fa fa-check"></i><b>9.6</b> The paired two sample t test</a></li>
<li class="chapter" data-level="9.7" data-path="week-5-lecture.html"><a href="week-5-lecture.html#the-f-test"><i class="fa fa-check"></i><b>9.7</b> The F test</a></li>
<li class="chapter" data-level="9.8" data-path="week-5-lecture.html"><a href="week-5-lecture.html#comparing-two-proportions"><i class="fa fa-check"></i><b>9.8</b> Comparing two proportions</a></li>
<li class="chapter" data-level="9.9" data-path="week-5-lecture.html"><a href="week-5-lecture.html#comparing-two-distributions"><i class="fa fa-check"></i><b>9.9</b> Comparing two distributions</a></li>
<li class="chapter" data-level="9.10" data-path="week-5-lecture.html"><a href="week-5-lecture.html#a-bit-more-detail-on-the-binomial"><i class="fa fa-check"></i><b>9.10</b> A bit more detail on the Binomial</a></li>
<li class="chapter" data-level="9.11" data-path="week-5-lecture.html"><a href="week-5-lecture.html#side-note-about-the-wald-test"><i class="fa fa-check"></i><b>9.11</b> Side-note about the Wald test</a></li>
<li class="chapter" data-level="9.12" data-path="week-5-lecture.html"><a href="week-5-lecture.html#chi-squared-goodness-of-fit-test"><i class="fa fa-check"></i><b>9.12</b> Chi-squared goodness-of-fit test</a></li>
<li class="chapter" data-level="9.13" data-path="week-5-lecture.html"><a href="week-5-lecture.html#chi-squared-test-of-independence"><i class="fa fa-check"></i><b>9.13</b> Chi-squared test of independence</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-5-lab.html"><a href="week-5-lab.html"><i class="fa fa-check"></i><b>10</b> Week 5 Lab</a>
<ul>
<li class="chapter" data-level="10.1" data-path="week-5-lab.html"><a href="week-5-lab.html#f-test"><i class="fa fa-check"></i><b>10.1</b> F-test</a></li>
<li class="chapter" data-level="10.2" data-path="week-5-lab.html"><a href="week-5-lab.html#comparing-two-proportions-1"><i class="fa fa-check"></i><b>10.2</b> Comparing two proportions</a></li>
<li class="chapter" data-level="10.3" data-path="week-5-lab.html"><a href="week-5-lab.html#comparing-two-distributions-1"><i class="fa fa-check"></i><b>10.3</b> Comparing two distributions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="week-6-lecture.html"><a href="week-6-lecture.html"><i class="fa fa-check"></i><b>11</b> Week 6 Lecture</a>
<ul>
<li class="chapter" data-level="11.1" data-path="week-6-lecture.html"><a href="week-6-lecture.html#week-6-readings"><i class="fa fa-check"></i><b>11.1</b> Week 6 Readings</a></li>
<li class="chapter" data-level="11.2" data-path="week-6-lecture.html"><a href="week-6-lecture.html#family-wise-error-rates"><i class="fa fa-check"></i><b>11.2</b> Family-wise error rates</a></li>
<li class="chapter" data-level="11.3" data-path="week-6-lecture.html"><a href="week-6-lecture.html#how-do-we-sort-the-signal-from-the-noise"><i class="fa fa-check"></i><b>11.3</b> How do we sort the signal from the noise?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="week-6-lab.html"><a href="week-6-lab.html"><i class="fa fa-check"></i><b>12</b> Week 6 Lab</a></li>
<li class="chapter" data-level="13" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html"><i class="fa fa-check"></i><b>13</b> Week 7 Lecture/Lab</a>
<ul>
<li class="chapter" data-level="13.1" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#week-7-readings"><i class="fa fa-check"></i><b>13.1</b> Week 7 Readings</a></li>
<li class="chapter" data-level="13.2" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#introduction-to-plotting-in-r"><i class="fa fa-check"></i><b>13.2</b> Introduction to plotting in R</a></li>
<li class="chapter" data-level="13.3" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#box-plots"><i class="fa fa-check"></i><b>13.3</b> Box plots</a></li>
<li class="chapter" data-level="13.4" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#two-dimensional-data"><i class="fa fa-check"></i><b>13.4</b> Two-dimensional data</a></li>
<li class="chapter" data-level="13.5" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#three-dimensional-data"><i class="fa fa-check"></i><b>13.5</b> Three-dimensional data</a></li>
<li class="chapter" data-level="13.6" data-path="week-7-lecturelab.html"><a href="week-7-lecturelab.html#multiple-plots"><i class="fa fa-check"></i><b>13.6</b> Multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="week-8-lecture.html"><a href="week-8-lecture.html"><i class="fa fa-check"></i><b>14</b> Week 8 Lecture</a>
<ul>
<li class="chapter" data-level="14.1" data-path="week-8-lecture.html"><a href="week-8-lecture.html#week-8-readings"><i class="fa fa-check"></i><b>14.1</b> Week 8 Readings</a></li>
<li class="chapter" data-level="14.2" data-path="week-8-lecture.html"><a href="week-8-lecture.html#warm-up"><i class="fa fa-check"></i><b>14.2</b> Warm-up</a></li>
<li class="chapter" data-level="14.3" data-path="week-8-lecture.html"><a href="week-8-lecture.html#the-aims-of-modelling-a-discussion-of-shmueli-2010"><i class="fa fa-check"></i><b>14.3</b> The aims of modelling – A discussion of Shmueli (2010)</a></li>
<li class="chapter" data-level="14.4" data-path="week-8-lecture.html"><a href="week-8-lecture.html#introduction-to-linear-models"><i class="fa fa-check"></i><b>14.4</b> Introduction to linear models</a></li>
<li class="chapter" data-level="14.5" data-path="week-8-lecture.html"><a href="week-8-lecture.html#linear-models-example-with-continuous-covariate"><i class="fa fa-check"></i><b>14.5</b> Linear models | example with continuous covariate</a></li>
<li class="chapter" data-level="14.6" data-path="week-8-lecture.html"><a href="week-8-lecture.html#resolving-overparameterization-using-contrasts"><i class="fa fa-check"></i><b>14.6</b> Resolving overparameterization using contrasts</a></li>
<li class="chapter" data-level="14.7" data-path="week-8-lecture.html"><a href="week-8-lecture.html#effect-codingtreatment-constrast"><i class="fa fa-check"></i><b>14.7</b> Effect coding/Treatment constrast</a></li>
<li class="chapter" data-level="14.8" data-path="week-8-lecture.html"><a href="week-8-lecture.html#helmert-contrasts"><i class="fa fa-check"></i><b>14.8</b> Helmert contrasts</a></li>
<li class="chapter" data-level="14.9" data-path="week-8-lecture.html"><a href="week-8-lecture.html#sum-to-zero-contrasts"><i class="fa fa-check"></i><b>14.9</b> Sum-to-zero contrasts</a></li>
<li class="chapter" data-level="14.10" data-path="week-8-lecture.html"><a href="week-8-lecture.html#polynomial-contrasts"><i class="fa fa-check"></i><b>14.10</b> Polynomial contrasts</a></li>
<li class="chapter" data-level="14.11" data-path="week-8-lecture.html"><a href="week-8-lecture.html#visualizing-hypotheses-for-different-coding-schemes"><i class="fa fa-check"></i><b>14.11</b> Visualizing hypotheses for different coding schemes</a></li>
<li class="chapter" data-level="14.12" data-path="week-8-lecture.html"><a href="week-8-lecture.html#orthogonal-vs.-non-orthogonal-contrasts"><i class="fa fa-check"></i><b>14.12</b> Orthogonal vs. Non-orthogonal contrasts</a></li>
<li class="chapter" data-level="14.13" data-path="week-8-lecture.html"><a href="week-8-lecture.html#error-structure-of-linear-models"><i class="fa fa-check"></i><b>14.13</b> Error structure of linear models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="week-8-lab.html"><a href="week-8-lab.html"><i class="fa fa-check"></i><b>15</b> Week 8 Lab</a>
<ul>
<li class="chapter" data-level="15.1" data-path="week-8-lab.html"><a href="week-8-lab.html#covariate-as-number-vs.-covariate-as-factor"><i class="fa fa-check"></i><b>15.1</b> Covariate as number vs. covariate as factor</a></li>
<li class="chapter" data-level="15.2" data-path="week-8-lab.html"><a href="week-8-lab.html#helmert-contrasts-in-r"><i class="fa fa-check"></i><b>15.2</b> Helmert contrasts in R</a></li>
<li class="chapter" data-level="15.3" data-path="week-8-lab.html"><a href="week-8-lab.html#polynomial-contrasts-in-r"><i class="fa fa-check"></i><b>15.3</b> Polynomial contrasts in R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="week-9-lecture.html"><a href="week-9-lecture.html"><i class="fa fa-check"></i><b>16</b> Week 9 Lecture</a>
<ul>
<li class="chapter" data-level="16.1" data-path="week-9-lecture.html"><a href="week-9-lecture.html#week-9-readings"><i class="fa fa-check"></i><b>16.1</b> Week 9 Readings</a></li>
<li class="chapter" data-level="16.2" data-path="week-9-lecture.html"><a href="week-9-lecture.html#correlation"><i class="fa fa-check"></i><b>16.2</b> Correlation</a></li>
<li class="chapter" data-level="16.3" data-path="week-9-lecture.html"><a href="week-9-lecture.html#hypothesis-testing---pearsons-r"><i class="fa fa-check"></i><b>16.3</b> Hypothesis testing - Pearson’s <em>r</em></a></li>
<li class="chapter" data-level="16.4" data-path="week-9-lecture.html"><a href="week-9-lecture.html#fishers-z"><i class="fa fa-check"></i><b>16.4</b> Fisher’s <span class="math inline">\(z\)</span></a></li>
<li class="chapter" data-level="16.5" data-path="week-9-lecture.html"><a href="week-9-lecture.html#regression"><i class="fa fa-check"></i><b>16.5</b> Regression</a></li>
<li class="chapter" data-level="16.6" data-path="week-9-lecture.html"><a href="week-9-lecture.html#estimating-the-slope-and-intercept-in-linear-regression"><i class="fa fa-check"></i><b>16.6</b> Estimating the slope and intercept in linear regression</a></li>
<li class="chapter" data-level="16.7" data-path="week-9-lecture.html"><a href="week-9-lecture.html#ok-now-the-other-derivation-for-slope-and-intercept"><i class="fa fa-check"></i><b>16.7</b> OK, now the “other” derivation for slope and intercept</a></li>
<li class="chapter" data-level="16.8" data-path="week-9-lecture.html"><a href="week-9-lecture.html#assumptions-of-regression"><i class="fa fa-check"></i><b>16.8</b> Assumptions of regression</a></li>
<li class="chapter" data-level="16.9" data-path="week-9-lecture.html"><a href="week-9-lecture.html#confidence-vs.-prediction-intervals"><i class="fa fa-check"></i><b>16.9</b> Confidence vs. Prediction intervals</a></li>
<li class="chapter" data-level="16.10" data-path="week-9-lecture.html"><a href="week-9-lecture.html#how-do-we-know-if-our-model-is-any-good"><i class="fa fa-check"></i><b>16.10</b> How do we know if our model is any good?</a></li>
<li class="chapter" data-level="16.11" data-path="week-9-lecture.html"><a href="week-9-lecture.html#robust-regression"><i class="fa fa-check"></i><b>16.11</b> Robust regression</a></li>
<li class="chapter" data-level="16.12" data-path="week-9-lecture.html"><a href="week-9-lecture.html#type-i-and-type-ii-regression"><i class="fa fa-check"></i><b>16.12</b> Type I and Type II Regression</a></li>
<li class="chapter" data-level="16.13" data-path="week-9-lecture.html"><a href="week-9-lecture.html#W9FAQ"><i class="fa fa-check"></i><b>16.13</b> Week 9 FAQ</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="week-9-lab.html"><a href="week-9-lab.html"><i class="fa fa-check"></i><b>17</b> Week 9 Lab</a>
<ul>
<li class="chapter" data-level="17.1" data-path="week-9-lab.html"><a href="week-9-lab.html#correlation-1"><i class="fa fa-check"></i><b>17.1</b> Correlation</a></li>
<li class="chapter" data-level="17.2" data-path="week-9-lab.html"><a href="week-9-lab.html#linear-modelling"><i class="fa fa-check"></i><b>17.2</b> Linear modelling</a></li>
<li class="chapter" data-level="17.3" data-path="week-9-lab.html"><a href="week-9-lab.html#weighted-regression"><i class="fa fa-check"></i><b>17.3</b> Weighted regression</a></li>
<li class="chapter" data-level="17.4" data-path="week-9-lab.html"><a href="week-9-lab.html#robust-regression-1"><i class="fa fa-check"></i><b>17.4</b> Robust regression</a></li>
<li class="chapter" data-level="17.5" data-path="week-9-lab.html"><a href="week-9-lab.html#bootstrapping-standard-errors-for-robust-regression"><i class="fa fa-check"></i><b>17.5</b> Bootstrapping standard errors for robust regression</a></li>
<li class="chapter" data-level="17.6" data-path="week-9-lab.html"><a href="week-9-lab.html#type-i-vs.-type-ii-regression-the-smatr-package"><i class="fa fa-check"></i><b>17.6</b> Type I vs. Type II regression: The ‘smatr’ package</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="week-10-lecture.html"><a href="week-10-lecture.html"><i class="fa fa-check"></i><b>18</b> Week 10 Lecture</a>
<ul>
<li class="chapter" data-level="18.1" data-path="week-10-lecture.html"><a href="week-10-lecture.html#week-10-readings"><i class="fa fa-check"></i><b>18.1</b> Week 10 Readings</a></li>
<li class="chapter" data-level="18.2" data-path="week-10-lecture.html"><a href="week-10-lecture.html#week-10-outline"><i class="fa fa-check"></i><b>18.2</b> Week 10 outline</a></li>
<li class="chapter" data-level="18.3" data-path="week-10-lecture.html"><a href="week-10-lecture.html#an-example"><i class="fa fa-check"></i><b>18.3</b> An example</a></li>
<li class="chapter" data-level="18.4" data-path="week-10-lecture.html"><a href="week-10-lecture.html#generalized-linear-models"><i class="fa fa-check"></i><b>18.4</b> Generalized linear models</a></li>
<li class="chapter" data-level="18.5" data-path="week-10-lecture.html"><a href="week-10-lecture.html#logistic-regression"><i class="fa fa-check"></i><b>18.5</b> Logistic regression</a></li>
<li class="chapter" data-level="18.6" data-path="week-10-lecture.html"><a href="week-10-lecture.html#fitting-a-glm"><i class="fa fa-check"></i><b>18.6</b> Fitting a GLM</a></li>
<li class="chapter" data-level="18.7" data-path="week-10-lecture.html"><a href="week-10-lecture.html#poisson-regression"><i class="fa fa-check"></i><b>18.7</b> Poisson regression</a></li>
<li class="chapter" data-level="18.8" data-path="week-10-lecture.html"><a href="week-10-lecture.html#deviance"><i class="fa fa-check"></i><b>18.8</b> Deviance</a></li>
<li class="chapter" data-level="18.9" data-path="week-10-lecture.html"><a href="week-10-lecture.html#other-methods-loess-splines-gams"><i class="fa fa-check"></i><b>18.9</b> Other methods – LOESS, splines, GAMs</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="week-10-lab.html"><a href="week-10-lab.html"><i class="fa fa-check"></i><b>19</b> Week 10 Lab</a>
<ul>
<li class="chapter" data-level="19.1" data-path="week-10-lab.html"><a href="week-10-lab.html#discussion-of-challenger-analysis"><i class="fa fa-check"></i><b>19.1</b> Discussion of Challenger analysis</a></li>
<li class="chapter" data-level="19.2" data-path="week-10-lab.html"><a href="week-10-lab.html#weighted-linear-regression"><i class="fa fa-check"></i><b>19.2</b> Weighted linear regression</a></li>
<li class="chapter" data-level="19.3" data-path="week-10-lab.html"><a href="week-10-lab.html#logistic-regression-practice"><i class="fa fa-check"></i><b>19.3</b> Logistic regression practice</a></li>
<li class="chapter" data-level="19.4" data-path="week-10-lab.html"><a href="week-10-lab.html#poisson-regression-practice"><i class="fa fa-check"></i><b>19.4</b> Poisson regression practice</a></li>
<li class="chapter" data-level="19.5" data-path="week-10-lab.html"><a href="week-10-lab.html#getting-a-feel-for-deviance"><i class="fa fa-check"></i><b>19.5</b> Getting a feel for Deviance</a></li>
<li class="chapter" data-level="19.6" data-path="week-10-lab.html"><a href="week-10-lab.html#generalized-additive-models"><i class="fa fa-check"></i><b>19.6</b> Generalized Additive Models</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="week-11-lecture.html"><a href="week-11-lecture.html"><i class="fa fa-check"></i><b>20</b> Week 11 Lecture</a>
<ul>
<li class="chapter" data-level="20.1" data-path="week-11-lecture.html"><a href="week-11-lecture.html#week-11-readings"><i class="fa fa-check"></i><b>20.1</b> Week 11 Readings</a></li>
<li class="chapter" data-level="20.2" data-path="week-11-lecture.html"><a href="week-11-lecture.html#week-11-outline"><i class="fa fa-check"></i><b>20.2</b> Week 11 outline</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="week-11-lecture.html"><a href="week-11-lecture.html#variation-within-treatment-group"><i class="fa fa-check"></i><b>20.2.1</b> Variation within treatment group</a></li>
<li class="chapter" data-level="20.2.2" data-path="week-11-lecture.html"><a href="week-11-lecture.html#variation-among-treatment-group-means"><i class="fa fa-check"></i><b>20.2.2</b> Variation among treatment group means</a></li>
<li class="chapter" data-level="20.2.3" data-path="week-11-lecture.html"><a href="week-11-lecture.html#comparing-variance-components"><i class="fa fa-check"></i><b>20.2.3</b> Comparing variance components</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="week-11-lecture.html"><a href="week-11-lecture.html#comparing-variance-components-1"><i class="fa fa-check"></i><b>20.3</b> Comparing variance components</a></li>
<li class="chapter" data-level="20.4" data-path="week-11-lecture.html"><a href="week-11-lecture.html#two-ways-to-estimate-variance"><i class="fa fa-check"></i><b>20.4</b> Two ways to estimate variance</a></li>
<li class="chapter" data-level="20.5" data-path="week-11-lecture.html"><a href="week-11-lecture.html#single-factor-anova"><i class="fa fa-check"></i><b>20.5</b> Single-factor ANOVA</a></li>
<li class="chapter" data-level="20.6" data-path="week-11-lecture.html"><a href="week-11-lecture.html#fixed-effects-vs.-random-effects"><i class="fa fa-check"></i><b>20.6</b> Fixed effects vs. random effects</a></li>
<li class="chapter" data-level="20.7" data-path="week-11-lecture.html"><a href="week-11-lecture.html#post-hoc-tests"><i class="fa fa-check"></i><b>20.7</b> Post-hoc tests</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="week-11-lecture.html"><a href="week-11-lecture.html#tukeys-hsd"><i class="fa fa-check"></i><b>20.7.1</b> Tukey’s HSD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="week-11-lab.html"><a href="week-11-lab.html"><i class="fa fa-check"></i><b>21</b> Week 11 Lab</a>
<ul>
<li class="chapter" data-level="21.1" data-path="week-11-lab.html"><a href="week-11-lab.html#rs-anova-functions"><i class="fa fa-check"></i><b>21.1</b> R’s ANOVA functions</a></li>
<li class="chapter" data-level="21.2" data-path="week-11-lab.html"><a href="week-11-lab.html#single-factor-anova-in-r"><i class="fa fa-check"></i><b>21.2</b> Single-factor ANOVA in R</a></li>
<li class="chapter" data-level="21.3" data-path="week-11-lab.html"><a href="week-11-lab.html#follow-up-analyses-to-anova"><i class="fa fa-check"></i><b>21.3</b> Follow up analyses to ANOVA</a></li>
<li class="chapter" data-level="21.4" data-path="week-11-lab.html"><a href="week-11-lab.html#more-practice-model-i-anova"><i class="fa fa-check"></i><b>21.4</b> More practice: Model I ANOVA</a></li>
<li class="chapter" data-level="21.5" data-path="week-11-lab.html"><a href="week-11-lab.html#more-practice-brief-intro-to-doing-model-ii-anova-in-r"><i class="fa fa-check"></i><b>21.5</b> More practice: Brief intro to doing Model II ANOVA in R</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="week-12-lecture.html"><a href="week-12-lecture.html"><i class="fa fa-check"></i><b>22</b> Week 12 Lecture</a>
<ul>
<li class="chapter" data-level="22.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#week-12-readings"><i class="fa fa-check"></i><b>22.1</b> Week 12 Readings</a></li>
<li class="chapter" data-level="22.2" data-path="week-12-lecture.html"><a href="week-12-lecture.html#week-12-outline"><i class="fa fa-check"></i><b>22.2</b> Week 12 outline</a></li>
<li class="chapter" data-level="22.3" data-path="week-12-lecture.html"><a href="week-12-lecture.html#review-anova-with-one-factor"><i class="fa fa-check"></i><b>22.3</b> Review: ANOVA with one factor</a></li>
<li class="chapter" data-level="22.4" data-path="week-12-lecture.html"><a href="week-12-lecture.html#anova-with-more-than-one-factor"><i class="fa fa-check"></i><b>22.4</b> ANOVA with more than one factor</a></li>
<li class="chapter" data-level="22.5" data-path="week-12-lecture.html"><a href="week-12-lecture.html#two-way-anova-factorial-designs"><i class="fa fa-check"></i><b>22.5</b> Two-way ANOVA factorial designs</a></li>
<li class="chapter" data-level="22.6" data-path="week-12-lecture.html"><a href="week-12-lecture.html#why-bother-with-random-effects"><i class="fa fa-check"></i><b>22.6</b> Why bother with random effects?</a></li>
<li class="chapter" data-level="22.7" data-path="week-12-lecture.html"><a href="week-12-lecture.html#mixed-model"><i class="fa fa-check"></i><b>22.7</b> Mixed model</a></li>
<li class="chapter" data-level="22.8" data-path="week-12-lecture.html"><a href="week-12-lecture.html#unbalanced-designs"><i class="fa fa-check"></i><b>22.8</b> Unbalanced designs</a>
<ul>
<li class="chapter" data-level="22.8.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#unbalanced-design-different-sample-sizes"><i class="fa fa-check"></i><b>22.8.1</b> Unbalanced design – Different sample sizes</a></li>
<li class="chapter" data-level="22.8.2" data-path="week-12-lecture.html"><a href="week-12-lecture.html#type-i-sequential-sums-of-squares"><i class="fa fa-check"></i><b>22.8.2</b> Type I (sequential) sums of squares</a></li>
<li class="chapter" data-level="22.8.3" data-path="week-12-lecture.html"><a href="week-12-lecture.html#type-ii-hierarchical-sums-of-squares"><i class="fa fa-check"></i><b>22.8.3</b> Type II (hierarchical) sums of squares</a></li>
<li class="chapter" data-level="22.8.4" data-path="week-12-lecture.html"><a href="week-12-lecture.html#type-iii-marginal-sums-of-squares"><i class="fa fa-check"></i><b>22.8.4</b> Type III (marginal) sums of squares</a></li>
<li class="chapter" data-level="22.8.5" data-path="week-12-lecture.html"><a href="week-12-lecture.html#comparing-type-i-ii-and-iii-ss"><i class="fa fa-check"></i><b>22.8.5</b> Comparing type I, II, and III SS</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="week-12-lecture.html"><a href="week-12-lecture.html#unbalanced-design-missing-cell"><i class="fa fa-check"></i><b>22.9</b> Unbalanced design – Missing cell</a></li>
<li class="chapter" data-level="22.10" data-path="week-12-lecture.html"><a href="week-12-lecture.html#two-factor-nested-anova"><i class="fa fa-check"></i><b>22.10</b> Two factor nested ANOVA</a>
<ul>
<li class="chapter" data-level="22.10.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#potential-issues-with-nested-designs"><i class="fa fa-check"></i><b>22.10.1</b> Potential issues with nested designs</a></li>
</ul></li>
<li class="chapter" data-level="22.11" data-path="week-12-lecture.html"><a href="week-12-lecture.html#experimental-design"><i class="fa fa-check"></i><b>22.11</b> Experimental design</a>
<ul>
<li class="chapter" data-level="22.11.1" data-path="week-12-lecture.html"><a href="week-12-lecture.html#completely-randomized-design"><i class="fa fa-check"></i><b>22.11.1</b> Completely randomized design</a></li>
<li class="chapter" data-level="22.11.2" data-path="week-12-lecture.html"><a href="week-12-lecture.html#randomized-block-design"><i class="fa fa-check"></i><b>22.11.2</b> Randomized block design</a></li>
<li class="chapter" data-level="22.11.3" data-path="week-12-lecture.html"><a href="week-12-lecture.html#latin-square-design"><i class="fa fa-check"></i><b>22.11.3</b> Latin square design</a></li>
<li class="chapter" data-level="22.11.4" data-path="week-12-lecture.html"><a href="week-12-lecture.html#split-plot-design"><i class="fa fa-check"></i><b>22.11.4</b> Split plot design</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="week-12-lab.html"><a href="week-12-lab.html"><i class="fa fa-check"></i><b>23</b> Week 12 Lab</a>
<ul>
<li class="chapter" data-level="23.1" data-path="week-12-lab.html"><a href="week-12-lab.html#example-1-two-way-factorial-anova-in-r"><i class="fa fa-check"></i><b>23.1</b> Example #1: Two-way factorial ANOVA in R</a></li>
<li class="chapter" data-level="23.2" data-path="week-12-lab.html"><a href="week-12-lab.html#example-2-nested-design"><i class="fa fa-check"></i><b>23.2</b> Example #2: Nested design</a></li>
<li class="chapter" data-level="23.3" data-path="week-12-lab.html"><a href="week-12-lab.html#example-3-nested-design"><i class="fa fa-check"></i><b>23.3</b> Example #3: Nested design</a></li>
<li class="chapter" data-level="23.4" data-path="week-12-lab.html"><a href="week-12-lab.html#example-4-randomized-block-design"><i class="fa fa-check"></i><b>23.4</b> Example #4: Randomized Block Design</a></li>
<li class="chapter" data-level="23.5" data-path="week-12-lab.html"><a href="week-12-lab.html#example-5-nested-design"><i class="fa fa-check"></i><b>23.5</b> Example #5: Nested design</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="week-13-lecture.html"><a href="week-13-lecture.html"><i class="fa fa-check"></i><b>24</b> Week 13 Lecture</a>
<ul>
<li class="chapter" data-level="24.1" data-path="week-13-lecture.html"><a href="week-13-lecture.html#week-13-readings"><i class="fa fa-check"></i><b>24.1</b> Week 13 Readings</a></li>
<li class="chapter" data-level="24.2" data-path="week-13-lecture.html"><a href="week-13-lecture.html#model-criticism"><i class="fa fa-check"></i><b>24.2</b> Model criticism</a></li>
<li class="chapter" data-level="24.3" data-path="week-13-lecture.html"><a href="week-13-lecture.html#residuals"><i class="fa fa-check"></i><b>24.3</b> Residuals</a></li>
<li class="chapter" data-level="24.4" data-path="week-13-lecture.html"><a href="week-13-lecture.html#leverage"><i class="fa fa-check"></i><b>24.4</b> Leverage</a></li>
<li class="chapter" data-level="24.5" data-path="week-13-lecture.html"><a href="week-13-lecture.html#influence"><i class="fa fa-check"></i><b>24.5</b> Influence</a></li>
<li class="chapter" data-level="24.6" data-path="week-13-lecture.html"><a href="week-13-lecture.html#comparing-residuals-leverage-and-influence"><i class="fa fa-check"></i><b>24.6</b> Comparing residuals, leverage, and influence</a></li>
<li class="chapter" data-level="24.7" data-path="week-13-lecture.html"><a href="week-13-lecture.html#residuals-for-glms"><i class="fa fa-check"></i><b>24.7</b> Residuals for GLMs</a></li>
<li class="chapter" data-level="24.8" data-path="week-13-lecture.html"><a href="week-13-lecture.html#model-selection-vs.-model-criticism"><i class="fa fa-check"></i><b>24.8</b> Model selection vs. model criticism</a></li>
<li class="chapter" data-level="24.9" data-path="week-13-lecture.html"><a href="week-13-lecture.html#comparing-two-models"><i class="fa fa-check"></i><b>24.9</b> Comparing two models</a>
<ul>
<li class="chapter" data-level="24.9.1" data-path="week-13-lecture.html"><a href="week-13-lecture.html#nested-or-not"><i class="fa fa-check"></i><b>24.9.1</b> Nested or not?</a></li>
<li class="chapter" data-level="24.9.2" data-path="week-13-lecture.html"><a href="week-13-lecture.html#likelihood-ratio-test-lrt"><i class="fa fa-check"></i><b>24.9.2</b> Likelihood Ratio Test (LRT)</a></li>
<li class="chapter" data-level="24.9.3" data-path="week-13-lecture.html"><a href="week-13-lecture.html#akaikes-information-criterion-aic"><i class="fa fa-check"></i><b>24.9.3</b> Akaike’s Information Criterion (AIC)</a></li>
<li class="chapter" data-level="24.9.4" data-path="week-13-lecture.html"><a href="week-13-lecture.html#bayesian-information-criterion-bic"><i class="fa fa-check"></i><b>24.9.4</b> Bayesian Information Criterion (BIC)</a></li>
<li class="chapter" data-level="24.9.5" data-path="week-13-lecture.html"><a href="week-13-lecture.html#comparing-lrt-and-aicbic"><i class="fa fa-check"></i><b>24.9.5</b> Comparing LRT and AIC/BIC</a></li>
</ul></li>
<li class="chapter" data-level="24.10" data-path="week-13-lecture.html"><a href="week-13-lecture.html#model-weighting"><i class="fa fa-check"></i><b>24.10</b> Model weighting</a></li>
<li class="chapter" data-level="24.11" data-path="week-13-lecture.html"><a href="week-13-lecture.html#stepwise-regression"><i class="fa fa-check"></i><b>24.11</b> Stepwise regression</a>
<ul>
<li class="chapter" data-level="24.11.1" data-path="week-13-lecture.html"><a href="week-13-lecture.html#criticism-of-stepwise-regression"><i class="fa fa-check"></i><b>24.11.1</b> Criticism of stepwise regression</a></li>
<li class="chapter" data-level="24.11.2" data-path="week-13-lecture.html"><a href="week-13-lecture.html#criticism-of-data-dredging"><i class="fa fa-check"></i><b>24.11.2</b> Criticism of data dredging</a></li>
<li class="chapter" data-level="24.11.3" data-path="week-13-lecture.html"><a href="week-13-lecture.html#final-thoughts-on-model-selection"><i class="fa fa-check"></i><b>24.11.3</b> Final thoughts on model selection</a></li>
</ul></li>
<li class="chapter" data-level="24.12" data-path="week-13-lecture.html"><a href="week-13-lecture.html#week-13-faq"><i class="fa fa-check"></i><b>24.12</b> Week 13 FAQ</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="week-13-lab.html"><a href="week-13-lab.html"><i class="fa fa-check"></i><b>25</b> Week 13 Lab</a>
<ul>
<li class="chapter" data-level="25.1" data-path="week-13-lab.html"><a href="week-13-lab.html#part-1-model-selection-model-comparison"><i class="fa fa-check"></i><b>25.1</b> Part 1: Model selection / model comparison</a></li>
<li class="chapter" data-level="25.2" data-path="week-13-lab.html"><a href="week-13-lab.html#model-selection-via-step-wise-regression"><i class="fa fa-check"></i><b>25.2</b> Model selection via step-wise regression</a></li>
<li class="chapter" data-level="25.3" data-path="week-13-lab.html"><a href="week-13-lab.html#part-2-model-criticism"><i class="fa fa-check"></i><b>25.3</b> Part 2: Model criticism</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="week-14-lecture.html"><a href="week-14-lecture.html"><i class="fa fa-check"></i><b>26</b> Week 14 Lecture</a>
<ul>
<li class="chapter" data-level="26.1" data-path="week-14-lecture.html"><a href="week-14-lecture.html#week-14-readings"><i class="fa fa-check"></i><b>26.1</b> Week 14 Readings</a></li>
<li class="chapter" data-level="26.2" data-path="week-14-lecture.html"><a href="week-14-lecture.html#what-does-multivariate-mean"><i class="fa fa-check"></i><b>26.2</b> What does ‘multivariate’ mean?</a></li>
<li class="chapter" data-level="26.3" data-path="week-14-lecture.html"><a href="week-14-lecture.html#multivariate-associations"><i class="fa fa-check"></i><b>26.3</b> Multivariate associations</a></li>
<li class="chapter" data-level="26.4" data-path="week-14-lecture.html"><a href="week-14-lecture.html#model-criticism-for-multivariate-analyses"><i class="fa fa-check"></i><b>26.4</b> Model criticism for multivariate analyses</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="week-14-lecture.html"><a href="week-14-lecture.html#transforming-your-data"><i class="fa fa-check"></i><b>26.4.1</b> Transforming your data</a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="week-14-lecture.html"><a href="week-14-lecture.html#standardizing-your-data"><i class="fa fa-check"></i><b>26.5</b> Standardizing your data</a></li>
<li class="chapter" data-level="26.6" data-path="week-14-lecture.html"><a href="week-14-lecture.html#multivariate-outliers"><i class="fa fa-check"></i><b>26.6</b> Multivariate outliers</a></li>
<li class="chapter" data-level="26.7" data-path="week-14-lecture.html"><a href="week-14-lecture.html#brief-overview-of-multivariate-analyses"><i class="fa fa-check"></i><b>26.7</b> Brief overview of multivariate analyses</a></li>
<li class="chapter" data-level="26.8" data-path="week-14-lecture.html"><a href="week-14-lecture.html#manova-and-dfa"><i class="fa fa-check"></i><b>26.8</b> MANOVA and DFA</a></li>
<li class="chapter" data-level="26.9" data-path="week-14-lecture.html"><a href="week-14-lecture.html#scaling-or-ordination-techniques"><i class="fa fa-check"></i><b>26.9</b> Scaling or ordination techniques</a></li>
<li class="chapter" data-level="26.10" data-path="week-14-lecture.html"><a href="week-14-lecture.html#principal-components-analysis-pca"><i class="fa fa-check"></i><b>26.10</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="26.11" data-path="week-14-lecture.html"><a href="week-14-lecture.html#principal-components-analysis-pca-1"><i class="fa fa-check"></i><b>26.11</b> Principal components analysis (PCA)</a></li>
<li class="chapter" data-level="26.12" data-path="week-14-lecture.html"><a href="week-14-lecture.html#pca-in-r"><i class="fa fa-check"></i><b>26.12</b> PCA in R</a></li>
<li class="chapter" data-level="26.13" data-path="week-14-lecture.html"><a href="week-14-lecture.html#missing-data"><i class="fa fa-check"></i><b>26.13</b> Missing data</a></li>
<li class="chapter" data-level="26.14" data-path="week-14-lecture.html"><a href="week-14-lecture.html#imputing-missing-data"><i class="fa fa-check"></i><b>26.14</b> Imputing missing data</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="week-14-lab.html"><a href="week-14-lab.html"><i class="fa fa-check"></i><b>27</b> Week 14 Lab</a>
<ul>
<li class="chapter" data-level="27.1" data-path="week-14-lab.html"><a href="week-14-lab.html#missing-at-random---practice-with-glms"><i class="fa fa-check"></i><b>27.1</b> Missing at random - practice with GLMs</a></li>
<li class="chapter" data-level="27.2" data-path="week-14-lab.html"><a href="week-14-lab.html#finally-a-word-about-grades"><i class="fa fa-check"></i><b>27.2</b> Finally, a word about grades</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biometry Lecture and Lab Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-2-lab" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Week 2 Lab<a href="week-2-lab.html#week-2-lab" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="confidence-intervals" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Confidence intervals<a href="week-2-lab.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before getting too far, we need to formally define a confidence interval.</p>
<p>A 95th percentile confidence interval say “If I repeat this procedure 100 times using 100 different datasets, 95% of the time my confidence intervals will capture the true parameter”. It does NOT say that there is a 95% chance that the parameter is in the interval.</p>
<p><strong>Quiz time! (Don’t worry, not a real quiz)</strong></p>
<p><em>Important note</em>: This is an area where Aho is <strong>WRONG</strong>. Aho is correct on only one point. It is true that <em>once the 95th CI has been constructed</em>, it is no longer possible to assign a <span class="math inline">\(\%\)</span> to the probability that that CI contains the true value or not. Because that CI, once created, either DOES or DOES NOT contain the true value. However, we often talk about the interval in the abstract. <strong><span style="color: orangered;">When we say “There is a 95<span class="math inline">\(\%\)</span> chance that the interval contains the true value” what we mean is that there is a 95<span class="math inline">\(\%\)</span> probability that a CI created using that methodology would contain the true value.</span></strong></p>
<p>Do not let Week 2 pass by without fundamentally understanding the interpretation of a confidence interval.</p>
<p>So now we know the general idea behind confidence intervals but we don’t yet know how to calculate them. To do that, we’ll actually walk through an example of bootstrap using pennies. Each of you should have gathered the ages of five pennies. (If a penny was made in 2021, that penny would be 1 year old, etc.)</p>
<p><em>Data</em>: 5 pennies that the students have</p>
<p><em>Test statistic</em>: Median</p>
<p>Lets say we are trying to find the median age of all pennies in circulation. We can’t figure this out exactly, because we can’t collect all the pennies in circulation, but we each have a sample of 5 pennies. The median age of the pennies in our sample is a reasonable estimate for the median age of all pennies in circulation.</p>
<p>What is our uncertainty about that number? How far might our estimate of the median age be from the true median age? In this case, we don’t know the underlying distribution of penny ages. (Let’s brainstorm this for a bit. Do we have any guesses what this distribution might look like? What might be a reasonable distribution to describe the shape of penny age?)</p>
<p>Let’s use bootstrapped samples to calculate the s.e. associated with that estimate.</p>
<p>Procedure:
1. Sample WITH REPLACEMENT a group of 5 pennies. (To sample with replacement you will have to sample one penny, write down the age, and repeat that 5 times.)
2. Calculate the median age from that sample of pennies.
3. Repeat</p>
<p>Do this a few times with your actual physical pennies, and then once you get the idea, you can make a vector in R of your penny ages and use R to speed up the sampling. Don’t forget to sample with replacement.</p>
<p>Gather a collection of 100 median estimates, each one calculated using a different bootstrapped dataset. Calculate the Bias and the Variance of the estimator for the Median.</p>
<p>We now want to take this one step further and estimate the confidence intervals for the median age of a penny in circulation. We actually have two primary mechanisms for generating confidence intervals for the statistic.</p>
<p><strong>Method #1</strong>: Simply take the quantiles directly from the distribution of <span class="math inline">\(\hat{\theta}^{*}\)</span>:</p>
<p><span class="math display">\[
\theta_{LL} = \mbox{2.5th percentile of } \hat{\theta}^{*}
\]</span>
<span class="math display">\[
\theta_{UL} = \mbox{97.5th percentile of } \hat{\theta}^{*}
\]</span></p>
<p>Notice that (by construction) 95<span class="math inline">\(%\)</span> of the <span class="math inline">\(\hat{\theta}^{*}\)</span> values fall in the interval <span class="math inline">\((\theta_{LL},\theta_{UL})\)</span>. <span style="color: orangered;">This is the very definition of the 95th percentile confidence interval.</span></p>
<p><strong>OR</strong></p>
<p><strong>Method #2</strong>: We can use the Normal approximation:</p>
<p>We have a second method that won’t make 100% sense until next week, but it turns out that if we assume the bootstrapped estimates follow a Normal distribution,</p>
<p><span class="math display">\[
\hat{\theta^{*}} \sim N(\hat{\theta},\hat{se}^{2})
\]</span></p>
<p>we can use the fact that the 95th percentile confidence interval is approximately given by:</p>
<p><span class="math display">\[
\hat{\theta}_{LL}=\hat{\theta}-1.96*\hat{se}
\]</span>
<span class="math display">\[
\hat{\theta}_{UL}=\hat{\theta}+1.96*\hat{se}
\]</span></p>
<p>It turns out that 95<span class="math inline">\(\%\)</span> of the probability for a Standard Normal distribution lies between (-1.96<span class="math inline">\(\sigma\)</span>,+1.96<span class="math inline">\(\sigma\)</span>). (We will show this more formally next week.)</p>
<p>NB: If you are going to go through the trouble of doing the bootstrap sampling, I don’t know why you would make a Normal approximation at the very end to construct the CIs. I recommend Method #1.</p>
<p><strong><span style="color: green;">Checkpoint #1: Use your penny data to calculate the 95th percentile confidence interval using Method #1 and Method #2. What did you get?</span></strong></p>
</div>
<div id="testing-hypotheses-through-permutation" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Testing hypotheses through permutation<a href="week-2-lab.html#testing-hypotheses-through-permutation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These examples use data on the speeds of the top 20 racing pigeons from a race in Alma, GA on February 7,2021.</p>
<p><strong>Example #1</strong>: Use permutation methods to test whether Cock or Hen birds fly at different speeds (speeds are in meters-per-minute) (in other word: <span class="math inline">\(H_{0}\)</span>: No difference in speeds between the C and H groups):</p>
<p>C=<span class="math inline">\(\{1359.8,1355.3,1355.1,1353.0,1349.8,1348.8,1345.2\}\)</span></p>
<p>H=<span class="math inline">\(\{1357.5,1356.4,1355.1,1353.5,1353.2,1352.5,1350.0,1349.8,1346.2,1344.9,1344.4,1343.9,1342.6\}\)</span></p>
<p><strong><span style="color: green;">Checkpoint #2: Is this a one-tailed or a two-tailed test?</span></strong></p>
<p>Make sure that you understand what is being done here, as this example is very closely related to the problem set.</p>
<p><strong>Example #2</strong>: Using the same data, provide a 95% confidence interval for the difference in mean speed based on 1000 bootstrap samples</p>
<p>Note that these two approaches are very closely related. Do you see why either approach can be used to test the null hypothesis? <strong><span style="color: green;">Checkpoint #3: What is the null hypothesis here?</span></strong></p>
<p><strong>Example #3</strong>: Now we will do one slightly more complicated example from Phillip Good’s book “Permutation tests: A practical guide to resampling methods and testing hypotheses”:</p>
<p>Holmes and Williams (1954) studied tonsil size in children to verify a possible association with the virus . Test for an association between status and tonsil size. (Note that you will need to come up with a reasonable test statistic.)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="Table2categories.png" alt="Data on tonsil size and S. pyrogenes status. Source: Good (1994)" width="40%" />
<p class="caption">
Figure 0.1: Data on tonsil size and S. pyrogenes status. Source: Good (1994)
</p>
</div>
<p>Now lets consider the full dataset, where tonsil size is divided into three categories. How would we do the test now? <strong><span style="color: green;">Checkpoint #4: What is the new test statistic? (There are many options.)</span></strong> What ‘labels’ do you permute?</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="Table3categories.png" alt="Fill dataset on tonsil size and S. pyrogenes status. Source: Good (1994)" width="50%" />
<p class="caption">
Figure 1.1: Fill dataset on tonsil size and S. pyrogenes status. Source: Good (1994)
</p>
</div>
</div>
<div id="basics-of-bootstrap-and-jackknife" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Basics of bootstrap and jackknife<a href="week-2-lab.html#basics-of-bootstrap-and-jackknife" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To get started with bootstrap and jackknife techniques, we start by working through a very simple example. First we simulate some data</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="week-2-lab.html#cb120-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="at">by=</span><span class="dv">1</span>)</span></code></pre></div>
<p>This will constutute our “data”. Let’s print the result of sampling with replacement to get a sense for it…</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="week-2-lab.html#cb121-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sample</span>(x,<span class="at">size=</span><span class="fu">length</span>(x),<span class="at">replace=</span>T))</span></code></pre></div>
<pre><code>## 
## 0 3 4 8 9 
## 2 2 2 2 2</code></pre>
<p>Now we will write a little script to take bootstrap samples and calculate the means of each of these bootstrap samples</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="week-2-lab.html#cb123-1" tabindex="-1"></a>xmeans<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb123-2"><a href="week-2-lab.html#cb123-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb123-3"><a href="week-2-lab.html#cb123-3" tabindex="-1"></a>  {</span>
<span id="cb123-4"><a href="week-2-lab.html#cb123-4" tabindex="-1"></a>  xmeans[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sample</span>(x,<span class="at">replace=</span>T))</span>
<span id="cb123-5"><a href="week-2-lab.html#cb123-5" tabindex="-1"></a>  }</span></code></pre></div>
<p>The actual number of bootstrapped samples is arbitrary <em>at this point</em> but there are ways of characterizing the precision of the bootstrap (jackknife-after-bootstrap) which might inform the number of bootstrap samples needed. <em>In practice</em>, people tend to pick some arbitrary but large number of bootstrap samples because computers are so fast that it is often easy to draw far more samples than are actually needed. When calculation of the statistic is slow (as might be the case if you are using the samples to construct a phylogeny, for example), then you would need to be more concerned with the number of bootstrap samples.</p>
<p>First, lets just look at a histogram of the bootstrapped means and plot the actual sample mean on the histogram for comparison</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="week-2-lab.html#cb124-1" tabindex="-1"></a><span class="fu">hist</span>(xmeans,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;pink&quot;</span>)</span>
<span id="cb124-2"><a href="week-2-lab.html#cb124-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(x),<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="calculating-bias-and-standard-error" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Calculating bias and standard error<a href="week-2-lab.html#calculating-bias-and-standard-error" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From these we can calculate the bias and standard deviation for the mean (which is the “statistic”):</p>
<p><span class="math display">\[
\widehat{Bias_{boot}} = \left(\frac{1}{k}\sum^{k}_{i=1}\theta^{*}_{i}\right)-\hat{\theta}
\]</span></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="week-2-lab.html#cb125-1" tabindex="-1"></a>bias.boot<span class="ot">&lt;-</span><span class="fu">mean</span>(xmeans)<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb125-2"><a href="week-2-lab.html#cb125-2" tabindex="-1"></a>bias.boot</span></code></pre></div>
<pre><code>## [1] 0.0062</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="week-2-lab.html#cb127-1" tabindex="-1"></a><span class="fu">hist</span>(xmeans,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;pink&quot;</span>)</span>
<span id="cb127-2"><a href="week-2-lab.html#cb127-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(x),<span class="at">lwd=</span><span class="dv">5</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb127-3"><a href="week-2-lab.html#cb127-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">mean</span>(xmeans),<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;yellow&quot;</span>)</span></code></pre></div>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><span class="math display">\[
\widehat{s.e._{boot}} = \sqrt{\frac{1}{k-1}\sum^{k}_{i=1}(\theta^{*}_{i}-\bar{\theta^{*}})^{2}}
\]</span></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="week-2-lab.html#cb128-1" tabindex="-1"></a>se.boot<span class="ot">&lt;-</span><span class="fu">sd</span>(xmeans)</span></code></pre></div>
<p>We can find the confidence intervals in two ways:</p>
<p>Method #1: Assume the bootstrap statistics are normally distributed</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="week-2-lab.html#cb129-1" tabindex="-1"></a>LL.boot<span class="ot">&lt;-</span><span class="fu">mean</span>(xmeans)<span class="sc">-</span><span class="fl">1.96</span><span class="sc">*</span>se.boot <span class="co">#where did 1.96 come from?</span></span>
<span id="cb129-2"><a href="week-2-lab.html#cb129-2" tabindex="-1"></a>UL.boot<span class="ot">&lt;-</span><span class="fu">mean</span>(xmeans)<span class="sc">+</span><span class="fl">1.96</span><span class="sc">*</span>se.boot</span>
<span id="cb129-3"><a href="week-2-lab.html#cb129-3" tabindex="-1"></a>LL.boot</span></code></pre></div>
<pre><code>## [1] 2.77584</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="week-2-lab.html#cb131-1" tabindex="-1"></a>UL.boot</span></code></pre></div>
<pre><code>## [1] 6.23656</code></pre>
<p>Method #2: Simply take the quantiles of the bootstrap statistics</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="week-2-lab.html#cb133-1" tabindex="-1"></a><span class="fu">quantile</span>(xmeans,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##  2.5% 97.5% 
##   2.7   6.1</code></pre>
<p>Let’s compare this to what we would have gotten if we had used normal distribution theory. First we have to calculate the standard error:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="week-2-lab.html#cb135-1" tabindex="-1"></a>se.normal<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb135-2"><a href="week-2-lab.html#cb135-2" tabindex="-1"></a>LL.normal<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>se.normal</span>
<span id="cb135-3"><a href="week-2-lab.html#cb135-3" tabindex="-1"></a>UL.normal<span class="ot">&lt;-</span><span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="fu">length</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>se.normal</span>
<span id="cb135-4"><a href="week-2-lab.html#cb135-4" tabindex="-1"></a>LL.normal</span></code></pre></div>
<pre><code>## [1] 2.334149</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="week-2-lab.html#cb137-1" tabindex="-1"></a>UL.normal</span></code></pre></div>
<pre><code>## [1] 6.665851</code></pre>
<p>In this case, the confidence intervals we got from the normal distribution theory are too wide.</p>
<p><strong><span style="color: green;">Checkpoint #6: Does it make sense why the normal distribution theory intervals are too wide?</span></strong> Because the original were were uniformly distributed, the data has higher variance than would be expected and therefore the standard error is higher than would be expected.</p>
<p>There are two packages that provide functions for bootstrapping, ‘boot’ and ‘boostrap’. We will start by using the ‘bootstrap’ package, which was originally designed for Efron and Tibshirani’s monograph on the bootstrap.</p>
<p>To test the main functionality of the ‘bootstrap’ package, we will use the data we already have. The ‘bootstrap’ function requires the input of a user-defined function to calculate the statistic of interest. Here I will write a function that calculates the mean of the input values.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="week-2-lab.html#cb139-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb139-2"><a href="week-2-lab.html#cb139-2" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb139-3"><a href="week-2-lab.html#cb139-3" tabindex="-1"></a>  {</span>
<span id="cb139-4"><a href="week-2-lab.html#cb139-4" tabindex="-1"></a>    <span class="fu">mean</span>(x)</span>
<span id="cb139-5"><a href="week-2-lab.html#cb139-5" tabindex="-1"></a>  }</span>
<span id="cb139-6"><a href="week-2-lab.html#cb139-6" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(<span class="at">x=</span>x,<span class="at">nboot=</span><span class="dv">1000</span>,<span class="at">theta=</span>theta)</span>
<span id="cb139-7"><a href="week-2-lab.html#cb139-7" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## $thetastar
##    [1] 3.8 3.4 4.5 4.4 4.5 5.1 4.3 5.7 4.6 3.3 3.9 5.8 6.4 4.6 4.5 3.5 5.1 5.7
##   [19] 3.9 5.3 5.0 3.8 5.1 4.9 3.4 5.4 3.2 5.1 5.2 5.6 5.0 2.9 4.3 2.9 4.5 3.0
##   [37] 4.3 3.9 5.8 4.3 5.4 4.6 4.7 4.3 4.3 5.8 5.0 4.4 5.4 3.9 5.3 2.9 4.0 5.2
##   [55] 3.6 6.2 4.5 4.2 3.9 3.6 4.0 5.4 5.9 4.4 4.4 5.5 4.8 3.6 5.3 3.2 6.1 4.5
##   [73] 6.1 2.7 4.9 3.4 5.2 3.5 5.3 6.0 6.0 5.0 6.7 4.7 3.0 4.6 3.7 4.3 4.4 3.7
##   [91] 4.8 3.5 5.2 4.4 4.8 3.9 5.1 5.9 4.3 3.5 5.2 4.1 4.8 4.3 5.2 5.0 4.3 3.0
##  [109] 4.2 4.2 5.1 5.5 5.9 5.3 4.9 4.5 3.7 4.6 3.8 4.5 3.5 3.2 3.6 4.9 5.7 5.0
##  [127] 4.9 4.9 4.4 3.4 4.2 4.4 3.0 3.3 4.7 3.3 5.1 5.0 3.5 5.6 3.3 4.6 4.4 3.3
##  [145] 4.9 3.8 4.9 3.7 4.9 5.2 4.7 4.5 5.1 3.8 5.2 3.8 3.1 4.3 6.6 4.8 4.8 5.3
##  [163] 2.9 4.7 5.7 4.8 4.6 4.3 4.8 3.3 3.8 5.9 3.9 5.9 5.2 5.6 3.0 4.7 4.9 3.3
##  [181] 4.2 4.0 3.8 5.4 4.6 3.8 3.9 5.5 3.8 3.0 5.6 6.1 6.5 3.7 4.9 4.7 5.9 4.7
##  [199] 6.7 4.6 2.5 4.4 5.0 4.0 5.2 3.4 4.1 5.0 5.7 5.7 2.6 3.5 5.7 5.8 5.9 4.5
##  [217] 5.4 3.5 5.5 4.2 4.3 3.9 5.7 4.1 5.7 3.4 3.5 4.7 3.7 6.9 4.8 3.4 4.6 6.5
##  [235] 2.7 4.3 3.9 3.0 3.1 4.2 3.7 5.8 5.5 3.2 4.5 5.0 5.6 4.3 3.9 4.6 3.0 6.1
##  [253] 3.8 4.8 5.4 4.7 4.3 4.1 3.9 4.8 5.2 3.7 4.5 4.5 4.8 3.9 3.7 4.2 4.0 3.1
##  [271] 6.0 5.7 5.3 2.9 5.5 5.7 6.0 4.9 4.3 4.1 4.4 4.7 4.0 4.3 5.0 5.7 4.2 5.0
##  [289] 4.6 5.3 4.7 4.0 4.1 5.4 4.6 3.7 6.4 3.5 5.9 3.8 5.1 4.2 4.1 4.3 5.9 5.6
##  [307] 5.8 3.9 3.8 4.2 4.5 3.5 5.4 4.6 5.5 4.4 5.1 3.7 4.6 5.8 4.1 5.1 3.9 4.2
##  [325] 4.4 3.7 3.6 4.5 4.4 5.4 3.3 3.5 3.7 3.8 4.5 5.8 4.4 3.0 4.7 3.8 5.5 6.2
##  [343] 4.1 3.2 3.2 2.9 3.9 4.1 3.8 4.1 4.4 4.3 5.8 2.4 4.5 3.3 6.1 5.0 5.2 3.0
##  [361] 4.8 4.7 2.8 4.1 3.7 4.1 6.0 4.7 4.5 3.2 4.9 3.6 6.1 3.9 4.4 5.5 3.7 3.7
##  [379] 4.0 4.4 4.8 3.6 4.7 4.3 3.9 3.6 4.7 4.1 4.9 5.2 3.9 5.1 4.5 4.8 6.0 4.3
##  [397] 4.5 6.1 3.6 5.6 5.1 5.0 4.4 5.2 4.4 3.5 4.7 5.3 4.0 3.8 5.9 4.1 2.8 4.9
##  [415] 3.8 5.9 5.7 5.3 5.1 4.0 3.7 4.3 4.9 5.9 3.8 4.4 4.9 5.4 4.3 4.5 4.1 6.0
##  [433] 5.4 4.1 3.8 4.3 4.9 5.0 3.8 6.2 4.1 4.1 3.9 4.7 5.4 4.6 4.8 4.8 4.8 5.4
##  [451] 4.6 3.0 5.2 5.1 4.4 3.2 4.2 3.9 6.4 6.2 4.5 5.5 5.4 4.2 3.9 5.1 3.6 2.9
##  [469] 3.5 4.4 4.6 6.0 4.2 4.3 5.8 3.4 4.9 4.7 4.0 4.5 3.7 5.1 5.8 5.7 4.6 3.7
##  [487] 4.0 2.5 5.1 3.6 4.7 4.4 1.8 4.9 4.8 3.9 3.0 5.1 4.9 4.4 5.0 4.5 5.2 4.0
##  [505] 3.4 5.1 6.3 4.3 4.7 4.3 4.8 4.7 5.7 4.8 5.0 4.9 5.5 4.7 4.7 5.5 5.3 3.1
##  [523] 3.7 5.8 5.3 3.7 5.6 4.0 3.6 6.1 3.8 3.5 3.5 3.1 4.6 3.3 4.5 5.3 3.5 5.0
##  [541] 4.7 3.7 4.7 4.2 4.5 5.9 3.5 3.5 5.2 3.7 4.0 3.8 6.4 5.4 3.2 4.4 4.4 4.9
##  [559] 3.3 4.9 5.6 4.8 4.9 4.0 3.9 4.6 3.9 4.1 5.7 5.1 4.7 3.7 6.1 6.4 4.7 3.9
##  [577] 3.8 5.9 5.9 3.4 5.4 4.6 5.7 4.2 5.4 4.6 5.1 3.9 3.8 5.3 3.6 3.5 3.6 4.8
##  [595] 3.7 4.2 4.3 4.6 5.4 5.0 8.1 4.7 2.8 5.3 3.8 5.7 4.3 5.1 6.2 3.7 4.4 3.4
##  [613] 4.7 3.9 4.3 4.7 4.6 6.5 5.4 5.2 3.0 4.2 4.2 5.2 5.0 5.1 5.0 5.4 5.0 4.6
##  [631] 4.3 3.7 5.6 4.7 5.5 5.3 3.8 4.3 4.6 4.2 4.7 5.1 4.4 2.7 3.4 5.6 4.7 2.5
##  [649] 3.9 6.3 5.7 5.3 5.6 5.0 4.7 5.3 5.2 3.7 4.5 3.2 4.3 3.6 4.2 4.1 3.6 3.3
##  [667] 2.5 5.4 3.8 6.0 5.6 3.8 3.5 3.9 4.1 4.8 4.2 5.5 5.1 4.1 5.2 2.9 4.2 4.1
##  [685] 5.0 5.0 3.4 4.4 5.1 5.0 5.5 4.1 5.1 5.1 4.9 4.8 5.7 4.7 4.2 5.3 5.1 5.3
##  [703] 4.8 4.4 5.2 3.5 3.2 5.1 5.5 3.6 4.5 4.2 4.0 5.3 4.3 3.7 5.3 3.9 4.5 4.9
##  [721] 3.4 4.0 5.1 5.7 3.6 6.3 4.6 5.1 5.1 4.4 2.8 4.3 4.6 4.7 5.6 5.4 4.1 3.1
##  [739] 4.7 2.9 5.5 5.3 3.1 5.2 4.4 6.0 3.5 5.8 3.9 4.7 4.3 4.3 4.6 4.2 2.7 3.4
##  [757] 3.6 4.9 5.5 5.0 5.2 4.9 4.6 4.4 3.7 2.7 4.6 4.6 4.1 4.8 3.7 5.4 4.2 2.5
##  [775] 4.4 2.6 5.7 4.3 5.9 4.9 3.7 4.0 5.1 5.3 4.6 3.1 5.3 3.4 4.7 2.8 3.4 4.0
##  [793] 5.0 6.2 3.4 6.1 3.6 3.4 6.2 4.0 3.9 5.5 4.3 3.8 3.6 5.0 5.3 4.0 3.7 3.5
##  [811] 5.8 4.1 3.9 5.1 3.9 5.1 6.0 4.7 5.3 4.4 5.5 5.8 4.5 6.3 5.0 3.4 6.5 2.8
##  [829] 4.3 3.4 5.0 4.7 4.8 3.5 4.5 5.2 5.3 5.6 3.9 5.3 5.9 4.8 4.9 4.7 5.2 6.3
##  [847] 3.8 4.4 5.9 2.9 4.5 5.3 4.0 6.0 3.9 3.0 5.9 3.3 4.9 4.9 3.6 4.6 4.5 5.9
##  [865] 3.9 4.7 4.0 4.2 4.5 3.9 4.8 4.2 5.5 4.4 4.9 3.7 4.6 5.9 5.8 5.7 5.5 5.4
##  [883] 5.4 2.9 5.0 2.9 4.4 4.7 4.6 4.6 4.8 4.5 3.6 3.3 5.8 5.3 4.6 4.9 5.2 3.3
##  [901] 4.2 4.7 5.0 4.6 4.6 4.1 5.2 3.0 5.5 5.3 4.1 3.8 6.8 4.4 5.1 4.3 3.3 4.9
##  [919] 3.2 5.1 3.7 5.3 3.8 3.7 5.4 3.5 4.2 2.9 3.2 3.7 5.7 6.2 4.5 5.2 3.7 4.6
##  [937] 4.6 4.1 4.3 5.0 3.2 4.7 4.2 4.3 4.8 3.6 3.8 3.9 4.3 4.2 3.6 4.3 5.0 3.4
##  [955] 3.3 4.7 5.3 4.2 5.3 2.6 3.9 2.8 5.2 3.9 3.6 3.9 5.3 4.9 4.5 4.4 4.3 4.8
##  [973] 4.6 4.3 3.2 5.2 4.4 4.4 4.0 4.5 4.0 4.7 4.7 5.5 4.4 4.7 4.3 4.2 5.9 3.5
##  [991] 4.9 4.6 4.0 5.0 5.0 5.4 5.6 3.3 3.4 4.0
## 
## $func.thetastar
## NULL
## 
## $jack.boot.val
## NULL
## 
## $jack.boot.se
## NULL
## 
## $call
## bootstrap(x = x, nboot = 1000, theta = theta)</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="week-2-lab.html#cb141-1" tabindex="-1"></a><span class="fu">quantile</span>(results<span class="sc">$</span>thetastar,<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##  2.5% 97.5% 
##   2.9   6.2</code></pre>
<p>Notice that we get exactly what we got last time. This illustrates an important point, which is that the bootstrap functions are often no easier to use than something you could write yourself.</p>
<p>You can also define a function of the bootstrapped statistics (we have been calling this theta) to pull out immediately any summary statistics you are interested in from the bootstrapped thetas.</p>
<p>Here I will write a function that calculates the bias of my estimate of the mean (which is 4.5 [i.e. the mean of the number 0,1,2,3,4,5,6,7,8,9])</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="week-2-lab.html#cb143-1" tabindex="-1"></a>bias<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb143-2"><a href="week-2-lab.html#cb143-2" tabindex="-1"></a>  {</span>
<span id="cb143-3"><a href="week-2-lab.html#cb143-3" tabindex="-1"></a>  <span class="fu">mean</span>(x)<span class="sc">-</span><span class="fl">4.5</span></span>
<span id="cb143-4"><a href="week-2-lab.html#cb143-4" tabindex="-1"></a>  }</span>
<span id="cb143-5"><a href="week-2-lab.html#cb143-5" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(<span class="at">x=</span>x,<span class="at">nboot=</span><span class="dv">1000</span>,<span class="at">theta=</span>theta,<span class="at">func=</span>bias)</span>
<span id="cb143-6"><a href="week-2-lab.html#cb143-6" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## $thetastar
##    [1] 4.4 4.8 3.8 3.9 3.5 4.7 4.3 3.3 4.9 3.5 5.0 5.2 4.5 3.2 4.7 4.7 4.6 3.0
##   [19] 4.1 4.4 5.8 3.5 6.0 4.4 4.0 4.1 3.2 4.0 4.3 4.3 5.2 5.2 4.8 4.7 2.3 5.1
##   [37] 4.4 4.9 2.8 4.6 4.7 4.1 4.0 4.8 3.5 6.0 5.1 3.7 4.8 5.8 5.5 4.1 5.1 5.8
##   [55] 5.1 5.6 3.9 3.9 3.0 4.7 5.1 3.6 2.5 4.6 3.8 4.7 5.7 5.5 5.0 5.7 4.1 2.6
##   [73] 5.6 5.2 4.7 4.2 3.3 4.3 4.8 4.7 3.9 2.5 4.4 4.0 4.3 3.0 4.5 4.3 4.1 5.7
##   [91] 6.6 4.2 5.1 4.3 4.1 4.4 5.3 5.3 4.0 4.2 4.0 4.9 4.4 4.3 4.1 2.4 5.0 5.3
##  [109] 3.7 3.4 3.6 2.8 4.7 3.6 5.1 4.5 5.3 3.7 5.1 5.3 4.0 5.7 3.6 4.7 5.2 3.8
##  [127] 5.4 5.4 5.2 5.4 4.2 5.0 2.8 5.8 2.7 5.5 4.9 4.1 3.4 5.3 4.6 4.8 4.2 3.4
##  [145] 4.6 5.9 5.1 5.1 3.5 5.0 6.2 4.7 3.6 4.5 5.4 3.2 4.3 3.8 4.4 4.6 4.0 5.5
##  [163] 4.8 4.4 4.9 6.3 3.6 4.3 4.8 4.3 5.4 3.6 4.2 3.1 4.3 5.3 3.9 3.8 4.2 5.2
##  [181] 4.1 5.4 4.5 4.7 3.7 5.4 3.9 3.9 4.9 5.2 5.8 3.9 5.2 4.8 3.3 4.0 3.3 4.2
##  [199] 4.6 4.9 6.2 4.6 3.9 5.3 5.4 4.4 4.1 3.2 3.6 5.1 3.6 2.9 3.2 4.2 5.6 4.4
##  [217] 3.9 2.9 4.3 6.6 5.0 5.9 6.0 3.7 5.9 5.5 3.8 2.7 3.6 4.1 6.1 3.5 4.0 3.6
##  [235] 3.3 3.9 5.1 5.0 4.5 4.1 3.6 4.7 4.7 4.7 3.9 4.7 5.1 4.5 3.7 5.6 2.9 3.0
##  [253] 4.8 3.4 3.7 3.0 5.4 4.9 4.1 3.4 4.7 5.1 5.7 3.7 3.8 3.8 5.1 4.4 4.8 3.2
##  [271] 5.7 4.8 3.5 5.2 5.4 3.7 3.0 5.4 3.6 5.7 6.1 4.5 3.0 4.5 2.9 4.5 3.3 3.7
##  [289] 4.1 2.3 3.9 4.9 6.2 4.5 5.7 5.4 4.8 3.7 4.5 4.3 6.0 4.8 5.3 5.1 5.0 4.7
##  [307] 4.3 6.1 5.2 3.2 4.6 2.4 4.4 3.2 5.8 5.2 5.2 3.7 2.8 4.6 6.3 3.5 5.4 5.2
##  [325] 3.2 4.6 4.6 3.7 6.1 4.9 4.3 4.3 5.4 6.2 4.2 4.4 4.5 5.5 5.0 4.3 4.8 3.7
##  [343] 3.9 2.8 6.8 4.0 4.5 4.8 3.7 3.5 4.0 3.7 4.9 2.5 3.5 4.5 3.1 4.4 5.5 2.7
##  [361] 4.6 3.7 5.8 4.3 5.5 3.4 5.3 4.6 4.4 4.0 3.1 3.9 7.1 4.8 5.7 5.1 4.6 4.9
##  [379] 5.6 5.5 5.4 4.2 4.4 3.2 5.0 4.6 6.2 4.8 5.2 3.4 4.6 4.6 5.9 3.4 3.6 3.1
##  [397] 4.0 4.4 4.3 5.6 5.8 3.9 6.9 4.9 5.0 4.0 4.4 5.4 5.4 4.4 5.3 3.8 2.2 5.5
##  [415] 4.2 5.9 4.7 5.3 4.1 6.8 3.3 4.9 5.8 2.7 4.7 4.0 6.8 4.9 5.1 4.1 3.6 4.1
##  [433] 4.8 3.4 3.2 4.0 5.7 4.6 4.2 4.6 3.1 3.9 3.2 4.0 5.8 6.2 3.2 4.4 4.6 3.4
##  [451] 4.0 2.8 5.9 6.5 2.7 4.3 3.9 3.2 3.9 3.6 5.7 5.2 3.5 2.8 4.0 3.8 3.4 5.3
##  [469] 2.4 4.3 4.3 4.6 2.9 3.8 1.9 4.8 3.9 5.7 3.5 5.3 5.5 5.4 2.7 3.9 5.9 5.7
##  [487] 4.1 4.9 4.8 4.0 5.0 4.8 5.0 3.6 3.2 5.8 4.4 4.3 3.7 4.9 3.7 5.1 4.0 3.3
##  [505] 4.5 4.6 4.2 4.0 5.8 4.5 4.6 3.3 4.8 3.5 3.2 3.5 4.8 4.5 3.5 5.0 2.2 3.8
##  [523] 3.7 5.6 3.5 4.4 4.6 6.3 4.1 3.2 3.5 4.4 5.6 5.1 3.1 5.1 4.9 3.0 3.7 5.9
##  [541] 5.5 3.8 4.7 4.9 4.0 4.3 4.5 3.9 3.8 4.4 5.4 5.2 4.0 3.1 5.1 4.9 4.5 5.2
##  [559] 4.9 5.3 4.0 2.8 4.0 4.1 5.2 4.6 5.1 6.3 5.3 5.4 4.0 4.2 3.2 5.0 3.5 2.9
##  [577] 6.4 4.6 4.4 4.9 3.4 4.2 4.2 4.2 4.8 3.7 6.3 3.7 5.7 4.8 4.3 5.9 4.6 3.6
##  [595] 5.4 3.8 6.3 4.7 5.8 4.0 5.0 6.3 4.2 5.7 4.6 3.1 4.2 5.7 4.3 4.7 4.4 5.4
##  [613] 4.8 4.9 4.7 2.6 4.2 4.7 2.8 2.7 5.9 5.2 2.8 5.7 3.5 3.5 1.7 3.7 3.6 4.0
##  [631] 3.6 4.2 4.9 7.0 5.1 5.1 3.8 3.5 4.9 5.4 4.3 2.8 4.5 4.2 5.3 2.9 5.1 3.3
##  [649] 5.3 4.3 5.7 5.9 5.6 3.9 2.9 5.3 6.6 4.8 4.8 4.3 5.6 3.3 4.6 4.4 2.1 4.9
##  [667] 3.0 4.6 4.1 5.2 5.1 5.0 4.2 4.5 6.5 4.1 4.0 4.0 5.6 3.9 5.0 5.4 3.6 5.1
##  [685] 3.5 2.5 6.6 4.1 4.0 3.6 4.5 2.4 2.7 3.8 4.8 4.9 5.4 4.2 4.2 5.0 4.8 4.8
##  [703] 4.1 4.6 4.5 4.7 4.5 5.0 3.7 3.6 5.4 5.2 4.8 5.1 4.8 2.9 4.1 3.4 2.7 4.8
##  [721] 3.7 6.5 3.6 4.2 3.9 4.7 2.2 4.6 4.4 4.5 5.1 4.9 5.4 4.5 4.0 4.0 3.8 4.8
##  [739] 6.0 2.8 5.7 5.8 3.0 3.2 2.5 5.4 5.1 4.6 4.7 4.7 4.3 5.3 4.9 7.2 4.5 6.0
##  [757] 4.0 5.2 3.6 5.1 3.4 5.7 5.3 4.1 5.4 4.0 5.5 3.9 4.1 4.5 5.3 5.8 5.3 4.8
##  [775] 4.7 5.7 4.2 5.7 4.9 5.8 2.4 5.1 5.7 4.4 5.3 3.8 6.0 4.4 5.3 5.5 4.3 3.5
##  [793] 4.0 4.3 3.6 4.6 4.1 2.9 4.0 5.9 4.7 5.0 5.0 4.7 5.0 4.3 5.7 4.5 4.1 3.0
##  [811] 5.0 3.7 2.7 4.1 4.6 4.9 4.2 5.5 4.6 2.4 5.1 5.4 3.7 4.0 3.8 4.2 5.4 3.5
##  [829] 3.7 5.8 5.4 3.4 3.9 3.9 5.4 5.2 2.9 4.8 3.6 5.7 4.8 3.8 6.4 4.1 3.6 4.6
##  [847] 5.2 3.6 3.8 4.2 6.2 4.8 4.9 4.6 4.5 5.1 5.7 5.1 3.8 4.9 3.6 4.1 4.6 6.0
##  [865] 3.8 3.6 4.3 6.1 5.7 4.5 4.4 4.2 5.2 2.8 5.0 5.7 3.6 2.4 3.6 4.4 4.8 4.3
##  [883] 3.8 5.1 4.9 4.2 4.4 5.3 4.1 2.6 5.1 5.2 3.4 4.6 3.5 4.8 4.1 4.7 3.7 4.8
##  [901] 5.1 4.6 3.3 4.3 4.3 3.8 2.8 2.5 4.9 4.2 2.7 3.6 3.9 3.9 5.6 4.8 5.7 3.8
##  [919] 3.4 6.5 4.4 5.2 4.0 3.4 4.6 6.0 3.7 2.8 4.5 6.4 4.7 4.7 4.3 4.9 3.6 4.6
##  [937] 3.3 4.1 5.6 3.2 5.2 3.5 5.8 5.4 5.2 3.2 3.2 3.8 5.6 3.2 5.0 7.1 3.8 4.7
##  [955] 3.9 4.0 5.3 5.8 4.1 3.7 4.2 4.1 5.2 3.4 3.1 3.7 4.3 3.8 4.2 5.0 3.8 5.1
##  [973] 4.2 5.0 5.1 4.3 5.5 3.7 4.1 4.9 5.0 4.2 4.4 3.6 5.4 5.0 4.3 4.5 5.3 5.1
##  [991] 3.8 4.5 6.8 3.4 4.8 4.9 5.4 3.9 4.4 3.3
## 
## $func.thetastar
## [1] -0.0445
## 
## $jack.boot.val
##  [1]  0.46204819  0.33017751  0.24756447  0.23896848 -0.04213483 -0.07842566
##  [7] -0.20488506 -0.34712991 -0.50512821 -0.50785340
## 
## $jack.boot.se
## [1] 0.9985197
## 
## $call
## bootstrap(x = x, nboot = 1000, theta = theta, func = bias)</code></pre>
<p>Compare this to ‘bias.boot’ (our result from above). Why might it not be the same? Try running the same section of code several times. See how the value of the bias ($func.thetastar) jumps around? We should not be surprised by this because we can look at the jackknife-after-bootstrap estimate of the standard error of the function (in this case, that function is the bias) and we can see that it is not so small that we wouldn’t expect some variation in these values.</p>
<p>Remember, everything we have discussed today are estimates. The statistic as applied to your data will change with new data, as will the standard error, the confidence intervals - everything! All of these values have sampling distributions and are subject to change if you repeated the procedure with new data.</p>
<p>Note that we can calculate any function of <span class="math inline">\(\theta^{*}\)</span>. A simple example would be the 72nd percentile:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="week-2-lab.html#cb145-1" tabindex="-1"></a>perc72<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb145-2"><a href="week-2-lab.html#cb145-2" tabindex="-1"></a>  {</span>
<span id="cb145-3"><a href="week-2-lab.html#cb145-3" tabindex="-1"></a>  <span class="fu">quantile</span>(x,<span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.72</span>))</span>
<span id="cb145-4"><a href="week-2-lab.html#cb145-4" tabindex="-1"></a>  }</span>
<span id="cb145-5"><a href="week-2-lab.html#cb145-5" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(<span class="at">x=</span>x,<span class="at">nboot=</span><span class="dv">1000</span>,<span class="at">theta=</span>theta,<span class="at">func=</span>perc72)</span>
<span id="cb145-6"><a href="week-2-lab.html#cb145-6" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## $thetastar
##    [1] 6.7 5.5 5.7 4.8 5.2 5.1 3.9 4.6 4.1 3.5 6.3 3.6 4.5 3.7 4.2 4.6 6.6 5.2
##   [19] 5.7 4.6 3.7 4.7 5.1 5.0 3.5 4.5 4.2 5.7 3.8 3.4 5.9 3.8 5.7 4.0 4.3 5.1
##   [37] 4.8 5.3 3.2 5.6 5.1 4.8 5.7 4.1 3.5 5.9 3.2 3.4 3.8 2.4 5.5 4.6 3.0 4.5
##   [55] 2.6 4.7 6.7 4.1 5.9 4.0 5.2 5.6 6.4 4.6 3.3 4.3 4.6 3.5 6.4 3.0 5.8 4.9
##   [73] 4.8 4.6 5.0 5.6 6.2 4.6 6.4 3.3 5.3 4.2 6.5 5.2 3.1 4.7 6.1 5.9 3.9 4.8
##   [91] 5.3 4.5 4.7 3.4 3.7 4.7 6.2 4.8 4.4 3.6 3.2 5.5 5.1 5.0 4.3 5.7 2.1 4.9
##  [109] 4.5 4.9 4.0 3.8 3.3 4.4 2.9 5.3 3.3 5.1 4.5 5.5 4.5 4.9 5.5 5.1 2.6 4.3
##  [127] 3.8 4.8 2.9 4.7 4.0 3.1 5.7 4.5 4.0 4.7 4.3 3.5 5.1 4.4 4.3 4.8 4.4 3.4
##  [145] 5.1 5.3 4.6 3.6 3.6 4.2 5.0 3.6 3.8 2.6 4.1 3.6 3.9 5.4 3.0 2.5 4.6 5.1
##  [163] 3.2 4.2 3.9 5.1 4.5 5.4 5.1 6.0 4.7 5.3 2.4 4.1 4.5 5.1 4.9 6.3 4.8 4.6
##  [181] 6.0 4.6 3.3 5.7 3.2 4.4 6.3 5.2 4.4 5.9 4.1 5.4 4.2 5.8 4.9 4.4 5.5 4.6
##  [199] 5.2 4.1 5.3 4.7 4.2 5.5 4.2 3.3 4.3 2.4 3.1 5.8 5.2 5.4 3.7 3.8 4.9 3.0
##  [217] 4.2 4.2 4.0 3.9 3.9 5.3 6.1 5.8 4.4 4.8 4.0 5.7 4.8 2.5 4.8 3.9 3.1 4.1
##  [235] 4.0 2.6 6.3 5.5 5.3 3.4 3.2 4.4 2.9 4.7 5.8 3.5 5.0 4.5 3.4 4.5 4.7 5.2
##  [253] 5.0 3.0 4.7 3.9 4.3 3.0 5.2 3.2 4.0 4.6 5.0 4.9 3.7 4.7 4.3 4.2 4.8 4.9
##  [271] 4.8 5.0 3.6 5.1 3.0 5.4 6.2 5.2 4.7 3.7 5.4 2.3 5.0 4.8 4.7 4.7 3.0 3.8
##  [289] 4.6 4.8 3.6 5.0 3.6 5.8 4.2 3.3 4.3 4.7 4.8 3.2 3.1 4.9 5.0 5.0 4.9 6.1
##  [307] 4.6 3.8 5.1 2.3 5.0 5.9 4.1 3.3 4.1 3.5 3.9 5.1 4.4 2.9 5.2 5.6 3.6 4.1
##  [325] 4.9 5.0 5.3 4.2 3.5 3.7 4.4 6.5 3.0 4.3 4.6 2.6 5.2 5.4 2.5 4.0 6.0 4.9
##  [343] 4.9 5.1 4.6 3.9 6.4 4.3 4.6 5.1 4.7 4.4 6.3 3.3 4.3 5.1 4.3 4.6 4.0 3.8
##  [361] 4.2 5.1 3.9 4.1 5.2 5.2 4.0 5.7 4.6 3.8 4.3 3.3 4.7 3.7 5.5 4.3 4.9 4.3
##  [379] 5.2 4.8 5.3 6.6 4.1 4.9 4.7 5.6 5.8 3.1 6.3 2.8 4.9 5.2 7.3 4.4 4.5 5.2
##  [397] 4.0 3.2 5.0 3.2 6.5 5.2 4.3 4.9 4.2 6.3 4.4 4.7 4.4 4.7 5.2 3.5 4.9 7.9
##  [415] 4.7 4.9 6.0 4.7 4.7 4.5 4.7 4.1 3.6 5.5 3.6 4.4 5.2 4.9 3.0 3.5 2.6 5.8
##  [433] 3.7 5.7 4.1 4.3 4.3 3.7 3.9 3.2 7.2 2.7 4.3 4.1 3.1 4.0 4.0 4.9 4.0 4.2
##  [451] 5.9 4.3 3.3 3.2 4.1 4.3 5.3 4.1 5.1 4.2 4.2 3.8 5.3 4.6 4.3 2.4 4.8 3.5
##  [469] 3.6 5.7 5.1 5.2 5.2 4.6 3.8 6.2 4.4 5.5 3.2 3.5 4.1 5.9 5.6 4.8 4.8 4.1
##  [487] 4.7 4.6 3.9 4.4 3.7 3.4 4.2 4.3 3.2 5.4 6.2 4.7 5.1 3.8 4.3 5.5 4.2 3.4
##  [505] 3.4 3.3 3.0 4.2 3.4 4.7 6.0 4.8 4.4 4.3 5.3 2.9 2.9 5.5 4.9 6.5 3.8 5.5
##  [523] 3.6 5.0 4.4 3.6 4.3 4.7 4.9 3.5 4.8 4.4 5.3 3.3 3.4 4.1 5.1 3.3 4.6 5.5
##  [541] 2.3 5.5 4.8 5.6 3.8 4.6 3.8 6.1 3.9 5.8 4.5 5.0 5.4 4.9 5.9 4.6 4.2 5.1
##  [559] 4.3 5.2 3.8 3.5 3.8 2.4 2.8 2.6 6.0 3.6 3.9 5.9 5.0 4.8 4.6 4.3 3.9 4.3
##  [577] 4.0 3.8 3.1 5.8 4.8 4.4 2.6 4.8 4.1 3.8 4.8 4.9 6.5 3.4 5.1 5.7 5.4 5.6
##  [595] 5.0 4.3 4.2 5.0 3.5 5.4 4.6 5.1 3.2 5.6 3.6 4.0 4.5 7.1 4.1 4.2 5.1 3.6
##  [613] 3.7 4.4 4.8 3.0 3.6 2.7 2.7 5.2 3.4 4.2 2.7 4.5 4.9 3.7 5.8 3.5 3.6 4.1
##  [631] 5.7 4.2 3.5 3.2 6.5 4.9 4.3 3.6 2.6 5.3 5.5 5.0 4.8 4.0 3.2 3.5 3.4 4.7
##  [649] 5.9 6.3 4.9 3.6 5.6 4.2 4.0 4.9 4.9 4.8 4.2 5.5 4.2 4.4 4.4 2.2 5.5 4.1
##  [667] 3.1 4.3 3.8 4.2 5.0 4.3 3.5 4.1 4.4 3.3 3.6 3.5 4.2 4.4 5.2 4.5 3.5 3.2
##  [685] 4.7 5.8 5.2 4.0 3.0 4.6 4.1 4.1 3.6 5.4 4.5 4.8 2.9 4.7 3.3 4.2 4.6 5.2
##  [703] 3.7 4.6 4.0 4.1 5.1 6.3 4.5 2.9 3.7 6.3 4.6 4.8 3.3 4.6 4.8 5.7 3.7 3.2
##  [721] 3.4 4.5 3.1 5.0 5.9 5.3 3.7 5.7 5.4 4.2 5.0 5.1 2.8 4.2 3.8 4.3 3.2 4.8
##  [739] 4.2 4.1 3.9 4.2 4.3 5.3 4.4 4.4 5.0 3.6 4.1 2.7 4.9 5.5 5.5 5.6 6.1 4.5
##  [757] 4.1 4.9 4.2 4.7 5.6 4.7 5.6 5.4 4.1 4.3 4.4 4.3 5.4 5.8 4.6 4.8 5.3 5.1
##  [775] 5.4 3.7 4.2 5.6 4.7 3.9 4.8 3.9 5.2 2.7 4.8 3.6 4.7 4.7 4.1 3.7 3.3 5.1
##  [793] 3.6 3.9 3.8 2.5 4.0 5.5 5.1 3.7 4.2 4.4 5.2 5.4 4.8 3.5 5.0 5.1 4.3 3.0
##  [811] 5.6 4.6 4.8 4.1 4.1 4.5 4.5 4.2 4.6 4.0 5.6 4.7 4.6 4.9 2.8 4.6 5.9 3.7
##  [829] 4.0 4.7 3.2 4.2 3.9 3.4 6.5 4.4 3.8 3.9 4.7 4.0 4.3 5.0 4.9 3.0 3.9 4.4
##  [847] 4.6 4.0 4.8 6.1 6.0 5.9 4.3 6.4 2.3 4.9 4.3 4.4 4.2 4.7 5.8 4.7 4.7 4.5
##  [865] 5.4 6.3 5.4 4.0 3.5 4.9 5.9 5.1 4.8 4.9 3.6 4.4 4.5 2.8 4.4 4.9 4.4 5.1
##  [883] 4.6 4.9 6.8 4.3 4.0 3.2 4.7 2.3 5.8 5.7 5.4 4.8 4.3 3.5 4.4 4.8 4.9 5.6
##  [901] 4.7 5.8 4.5 3.0 4.0 4.1 3.5 3.2 3.9 4.6 4.7 4.3 4.9 4.6 3.6 2.9 4.1 4.4
##  [919] 3.4 3.6 3.4 1.6 4.1 4.5 5.2 4.2 3.6 3.9 5.1 4.5 5.6 5.3 3.3 4.0 6.4 3.5
##  [937] 4.0 4.8 5.1 3.6 5.3 4.8 4.9 6.3 6.4 2.9 3.1 5.1 6.2 3.7 5.9 4.1 3.0 5.4
##  [955] 5.5 4.3 4.0 5.6 4.6 3.9 5.0 4.8 4.5 4.3 4.4 4.1 3.2 4.1 5.2 3.8 5.0 4.3
##  [973] 3.8 4.3 6.3 4.0 5.9 6.7 5.3 2.4 4.7 5.0 5.4 3.5 4.3 4.5 5.4 3.9 3.5 3.8
##  [991] 3.8 4.3 4.9 5.3 5.7 4.5 4.7 3.5 5.8 5.8
## 
## $func.thetastar
## 72% 
##   5 
## 
## $jack.boot.val
##  [1] 5.42 5.50 5.20 5.20 5.10 4.90 4.80 4.70 4.60 4.40
## 
## $jack.boot.se
## [1] 1.027543
## 
## $call
## bootstrap(x = x, nboot = 1000, theta = theta, func = perc72)</code></pre>
<p>On Tuesday we went over an example in which we bootstrapped the correlation coefficient between LSAT scores and GPA. To do that, we sampled pairs of (LSAT,GPA) data with replacement. Here is a little script that would do something like that using (X,Y) data that are independently drawn from the normal distribution</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="week-2-lab.html#cb147-1" tabindex="-1"></a>xdata<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>),<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p>Everyone’s data is going to be different. With such a small sample size, it would be easy to get a positive or negative correlation by random change, but on average across everyone’s datasets, there should be zero correlation because the two columns are drawn independently.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="week-2-lab.html#cb148-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">15</span></span>
<span id="cb148-2"><a href="week-2-lab.html#cb148-2" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="cf">function</span>(x,xdata)</span>
<span id="cb148-3"><a href="week-2-lab.html#cb148-3" tabindex="-1"></a>  {</span>
<span id="cb148-4"><a href="week-2-lab.html#cb148-4" tabindex="-1"></a>  <span class="fu">cor</span>(xdata[x,<span class="dv">1</span>],xdata[x,<span class="dv">2</span>])</span>
<span id="cb148-5"><a href="week-2-lab.html#cb148-5" tabindex="-1"></a>  }</span>
<span id="cb148-6"><a href="week-2-lab.html#cb148-6" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>n,<span class="at">nboot=</span><span class="dv">50</span>,<span class="at">theta=</span>theta,<span class="at">xdata=</span>xdata) </span>
<span id="cb148-7"><a href="week-2-lab.html#cb148-7" tabindex="-1"></a><span class="co">#NB: xdata is passed to the theta function, not needed for bootstrap function itself</span></span></code></pre></div>
<p>Notice the parameters that get passed to the ‘bootstrap’ function are: (1) the indexes which will be sampled with replacement. This is different that the raw data but the end result is the same because both the indices and the raw data get passed to the function ‘theta’ (2) the number of bootrapped samples (in this case 50) (3) the function to calculate the statistic (4) the raw data.</p>
<p>Lets look at a histogram of the bootstrapped statistics <span class="math inline">\(\theta^{*}\)</span> and draw a vertical line for the statistic as applied to the original data.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="week-2-lab.html#cb149-1" tabindex="-1"></a><span class="fu">hist</span>(results<span class="sc">$</span>thetastar,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;pink&quot;</span>)</span>
<span id="cb149-2"><a href="week-2-lab.html#cb149-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">cor</span>(xdata[,<span class="dv">1</span>],xdata[,<span class="dv">2</span>]),<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="parametric-bootstrap-1" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Parametric bootstrap<a href="week-2-lab.html#parametric-bootstrap-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s do one quick example of a parametric bootstrap. We haven’t introduced distributions yet (except for the Gaussian, or Normal, distribution, which is the most familiar), so lets spend a few minutes exploring the Gamma distribution, just so we have it to work with for testing out parametric bootstrap. All we need to know is that the Gamma distribution is a continuous, non-negative distribution that takes two parameters, which we call “shape” and “rate”. Lets plot a few examples just to see what a Gamma distribution looks like. (Note that the Gamma distribution can be parameterized by “shape” and “rate” OR by “shape” and “scale”, where “scale” is just 1/“rate”. R will allow you to use either (shape,rate) or (shape,scale) as long as you specify which you are providing.</p>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Let’s generate some fairly sparse data from a Gamma distribution</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="week-2-lab.html#cb150-1" tabindex="-1"></a>original.data<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span></code></pre></div>
<p>and calculate the skew of the data using the R function ‘skewness’ from the ‘moments’ package.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="week-2-lab.html#cb151-1" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb151-2"><a href="week-2-lab.html#cb151-2" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="fu">skewness</span>(original.data)</span>
<span id="cb151-3"><a href="week-2-lab.html#cb151-3" tabindex="-1"></a><span class="fu">head</span>(theta)</span></code></pre></div>
<pre><code>## [1] -1.066861</code></pre>
<p>What is skew? Skew describes how assymetric a distribution is. A distribution with a positive skew is a distribution that is “slumped over” to the right, with a right tail that is longer than the left tail. Alternatively, a distribution with negative skew has a longer left tail. Here we are just using it for illustration, as a property of a distribution that you may want to estimate using your data.</p>
<p>Lets use ‘fitdistr’ to fit a gamma distribution to these data. This function is an extremely handy function that takes in your data, the name of the distribution you are fitting, and some starting values (for the estimation optimizer under the hood), and it will return the parameter values (and their standard errors). We will learn in a couple weeks how R is doing this, but for now we will just use it out of the box. (Because we generated the data, we happen to know that the data are gamma distributed. In general we wouldn’t know that, and we will see in a second that our assumption about the shape of the data really does make a difference.)</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="week-2-lab.html#cb153-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb153-2"><a href="week-2-lab.html#cb153-2" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">fitdistr</span>(original.data,dgamma,<span class="fu">list</span>(<span class="at">shape=</span><span class="dv">1</span>,<span class="at">rate=</span><span class="dv">1</span>))</span>
<span id="cb153-3"><a href="week-2-lab.html#cb153-3" tabindex="-1"></a><span class="co"># fit&lt;-fitdistr(original.data,&quot;gamma&quot;)</span></span>
<span id="cb153-4"><a href="week-2-lab.html#cb153-4" tabindex="-1"></a><span class="co"># The second version would also work.</span></span>
<span id="cb153-5"><a href="week-2-lab.html#cb153-5" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>##     shape       rate  
##   4.497639   7.159457 
##  (1.941412) (3.269583)</code></pre>
<p>Now lets sample with replacement from this new distribution and calculate the skewness at each step:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="week-2-lab.html#cb155-1" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb155-2"><a href="week-2-lab.html#cb155-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb155-3"><a href="week-2-lab.html#cb155-3" tabindex="-1"></a>  {</span>
<span id="cb155-4"><a href="week-2-lab.html#cb155-4" tabindex="-1"></a>  x.star<span class="ot">&lt;-</span><span class="fu">rgamma</span>(<span class="fu">length</span>(original.data),<span class="at">shape=</span>fit<span class="sc">$</span>estimate[<span class="dv">1</span>],<span class="at">rate=</span>fit<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb155-5"><a href="week-2-lab.html#cb155-5" tabindex="-1"></a>  results<span class="ot">&lt;-</span><span class="fu">c</span>(results,<span class="fu">skewness</span>(x.star))</span>
<span id="cb155-6"><a href="week-2-lab.html#cb155-6" tabindex="-1"></a>  }</span>
<span id="cb155-7"><a href="week-2-lab.html#cb155-7" tabindex="-1"></a><span class="fu">head</span>(results)</span></code></pre></div>
<pre><code>## [1]  0.3444345  1.7045609  0.8475298  1.1143255 -0.1914404  0.5444422</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="week-2-lab.html#cb157-1" tabindex="-1"></a><span class="fu">hist</span>(results,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;pink&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">freq=</span>F)</span></code></pre></div>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Now we have the bootstrap distribution for skewness (the <span class="math inline">\(\theta^{*}\)</span> s), we can compare that to the equivalent non-parametric bootstrap:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="week-2-lab.html#cb158-1" tabindex="-1"></a>results2<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(<span class="at">x=</span>original.data,<span class="at">nboot=</span><span class="dv">1000</span>,<span class="at">theta=</span>skewness)</span>
<span id="cb158-2"><a href="week-2-lab.html#cb158-2" tabindex="-1"></a>results2</span></code></pre></div>
<pre><code>## $thetastar
##    [1] -1.953002836 -1.819561975 -1.870001820 -1.098411323 -2.541024211
##    [6] -0.698659519 -0.635102818 -0.744956693 -1.440900697 -2.145168214
##   [11] -1.295786406 -0.480120452 -0.955330682 -1.146676362 -0.745752422
##   [16] -2.419982570 -0.468793824 -0.970221538 -0.791079043 -0.331537029
##   [21] -1.261718716 -0.634937513 -1.073036865 -1.877481366 -1.262640849
##   [26] -1.049726623 -0.863009341 -0.950835660 -0.636706180 -0.969480057
##   [31] -1.854891333 -1.606746856 -2.433668983 -0.976564378 -0.845449165
##   [36] -0.564373098 -1.550716449 -1.775870543 -0.569126044 -1.143645388
##   [41] -0.905910122 -0.286028403 -1.055465135 -2.284025753 -1.386488472
##   [46] -2.214493676 -1.717258071 -1.292731160 -0.975775093 -0.641512081
##   [51] -0.110144576 -0.441445711 -0.399940736 -0.396779232 -1.249824335
##   [56] -0.917673898 -1.403144068 -0.775072267 -0.167330997 -0.669485899
##   [61] -0.795221013 -1.289782115 -0.889783061 -0.256189409 -1.481277470
##   [66] -1.315233511 -0.858368974 -0.048688509 -2.181313779 -0.627163965
##   [71] -0.449900769 -0.544319855 -0.640637962 -0.777287185 -1.375386543
##   [76] -1.264219866 -2.382602604 -1.467226178 -2.143970178 -1.034211998
##   [81] -0.231855058 -0.506345104 -1.703646671 -1.667760509 -0.864017975
##   [86] -0.344676620 -0.243021224 -0.837938160 -1.610142109 -0.038194836
##   [91] -2.466734996 -0.454330297 -0.389838419 -1.719909037 -0.815264429
##   [96] -1.084635430 -0.163334755 -2.459778995 -0.353888440 -1.632975131
##  [101] -2.626950467 -1.544175287 -1.628016103 -0.782156075 -0.780265783
##  [106] -0.398416732 -1.047501972 -0.780116983 -1.258182988 -0.735735891
##  [111] -1.738495600 -1.341595021 -0.741708414 -0.759280188  0.082817244
##  [116]  0.191637974 -1.203625257 -0.611346244 -0.607158637 -0.969264654
##  [121] -1.434458093 -1.255525491 -1.127621266 -1.221614173 -0.939617579
##  [126] -0.520894886 -0.780184266 -2.318399515 -0.569078202 -0.226936695
##  [131] -0.966404481 -0.092843447 -0.443943935 -0.403875759 -1.428713236
##  [136] -0.448946458 -0.798346208  0.017208733 -0.654758143 -0.759140565
##  [141] -0.822808799 -1.992233637 -1.048471156 -1.067206970 -2.193723905
##  [146] -0.604347692 -0.800959552 -0.775187164 -0.480016095 -0.384450227
##  [151] -0.976002455 -0.839631949 -0.382041670 -1.316606393 -0.466847550
##  [156] -2.192940672 -1.864601228 -0.599098233 -0.884751148 -1.328700177
##  [161] -1.406621858 -0.902088762 -0.242804776 -0.833329318 -1.358853477
##  [166] -0.220286453 -0.594514621 -2.365389241 -1.327976017 -0.976937687
##  [171] -0.678906439 -0.288674422 -0.066969840 -2.469596195 -1.083777890
##  [176]  0.301189455 -1.350848505  0.194832921 -0.618468704 -0.478434266
##  [181] -1.375732776 -1.154412085  0.066106605 -1.778906435 -0.816612949
##  [186] -0.368849742 -2.141038200 -1.421976368 -0.398470585 -0.699307145
##  [191] -0.954243493 -1.601425479 -0.611361094 -1.074473315 -0.826781760
##  [196] -1.465068956 -1.573922426 -1.465615512 -0.648405861 -1.400782601
##  [201] -0.252989114 -1.387062083 -1.350397922 -1.069144089 -0.585389043
##  [206] -0.334693016 -0.594144658 -0.366815393 -0.867915630 -1.363571458
##  [211] -0.348238730 -0.030564678 -0.870313266 -0.911059723 -1.238412470
##  [216] -0.896928097 -1.563530236 -1.335119533 -0.265517802 -0.891050812
##  [221] -0.673723376 -1.101654386 -0.392049244 -1.491394626 -1.588903302
##  [226] -0.521424910 -0.232355250 -1.522112868 -1.078783771 -1.915231899
##  [231] -2.353798562 -1.475340171 -0.908117905 -0.285162479 -0.513488708
##  [236] -1.826379889 -1.834381409 -1.660880297 -2.222177794 -1.282816081
##  [241] -0.358644155 -1.298039459 -0.286028403 -0.941257420 -0.526610636
##  [246] -1.001147504 -0.641708498 -0.480016095 -0.428519729 -1.069098191
##  [251] -0.951290524 -2.152049435 -1.167914836 -0.442467789 -1.395340720
##  [256] -1.578575195 -0.832147499 -1.703688935 -1.576450806 -1.893254744
##  [261] -1.360569476 -0.591444894 -1.040099328 -0.832644683 -0.621506080
##  [266] -0.176440013 -0.568772105 -0.776956800 -0.943033836 -1.716980338
##  [271] -1.662179449 -0.008000689 -1.042346555 -0.863149797 -0.884013642
##  [276] -0.358462438 -1.065523613 -0.138041390 -0.721453925 -0.040531934
##  [281] -1.337828196 -1.141396961 -0.465197527 -0.450418913 -1.393395569
##  [286] -1.744983146 -0.106834176 -0.928596218 -1.734451624 -0.813514039
##  [291] -0.843130437 -1.122365331 -1.455217379 -0.360309705 -1.008860432
##  [296] -2.376260730 -0.015025853 -0.933763869 -0.660091178 -1.057588095
##  [301] -2.240139806 -0.527699164 -1.595979634 -0.082115214 -1.824735697
##  [306] -2.204635028 -2.381422937 -1.386822556 -1.055851445 -0.932201777
##  [311] -1.392092710 -0.662805969 -1.242973844 -0.991092231 -1.554024273
##  [316] -0.381166182 -0.812743086 -0.843350767 -0.415187536 -0.818473535
##  [321] -1.582424568 -0.398321075 -0.099270832 -0.402116741 -1.971106215
##  [326] -1.896003502 -0.407420146 -1.618157569 -0.680946629 -0.558392034
##  [331] -1.659733003 -1.283641050 -0.920434065 -1.150564150 -0.481466217
##  [336] -1.139405981 -0.378612640 -0.159530837 -0.735746215 -0.760421950
##  [341] -0.746346479 -1.700292655 -2.130978191 -0.309316233 -1.056400326
##  [346] -0.501197857 -1.372419502 -0.794333111 -1.485595499 -1.468505671
##  [351] -0.975062274 -0.677233721 -2.591529486 -0.105865555 -0.884995523
##  [356] -1.877546407 -1.133905569 -1.352076825 -0.992384939 -1.487495778
##  [361] -2.036997251 -1.773218752 -0.622806030 -0.987525862 -1.557953685
##  [366] -1.701113156 -1.853854148 -1.310155128 -1.458015755 -0.166471551
##  [371] -1.852767925 -1.471364882 -0.638362282 -1.516285151 -0.990446292
##  [376] -1.511119634 -1.361323040 -2.195606910 -1.608398295 -1.373694128
##  [381] -1.737607866 -0.341699098 -0.800931516 -1.522112868 -0.269322466
##  [386] -1.165190262  0.547163061 -2.388570896 -1.384251671 -2.310509017
##  [391]  0.075035607 -0.028129981 -2.231126045 -0.384729889 -1.537183325
##  [396] -0.235546965 -0.746465990 -1.555303039 -0.645873895 -1.339690815
##  [401] -0.387077865 -1.986010782 -0.255981372 -1.091149293 -1.068775241
##  [406] -1.128122543 -0.416844202 -0.870892919 -0.634508381 -1.100982600
##  [411] -0.807204279 -0.155564043 -0.923665138 -0.200306630 -0.874849397
##  [416] -0.367270338 -0.725015294 -1.273408117 -1.113109941 -0.772928516
##  [421] -1.278962645 -0.586821259 -0.324507744 -0.612357151 -2.209979423
##  [426] -1.083918347 -0.582829678 -0.392993104 -1.206343663 -0.440029763
##  [431] -1.018077224 -0.929791287  0.303740953 -1.464480096 -0.241837916
##  [436] -1.414696294 -0.744934261 -2.204686453 -1.066861221 -1.488069179
##  [441] -1.011786182 -1.136897295 -1.268904572 -0.817819261 -0.848336644
##  [446] -1.074033777 -0.028900147 -1.395705731 -0.247910769 -2.080263196
##  [451] -0.244615560 -0.688147493 -1.316510805 -0.890922166 -0.790619313
##  [456] -0.962331246 -1.902502161 -0.421946782 -0.320517836 -0.801888365
##  [461] -0.160933683 -1.093439503 -1.161188768 -1.972121205 -1.032073616
##  [466] -1.648830994 -0.063107257 -1.605358795 -0.762131806 -0.771910302
##  [471] -0.392289359 -1.033296735 -1.337234144  0.020992673 -1.436642359
##  [476] -2.182723307 -0.266359650 -1.231243670 -1.005326202 -1.238065923
##  [481] -0.377313680 -1.487637914 -0.589758019  1.469367597 -1.225375077
##  [486] -0.507013461 -0.854117060 -0.203296945 -0.814319262 -0.256872509
##  [491] -0.886433929 -1.385107851 -2.403337671 -0.708624468 -2.086613358
##  [496] -1.383636174  0.098047400 -0.424030978 -0.863742185 -0.976554323
##  [501] -0.824686323 -0.390606593 -2.235094685 -1.503707960 -2.333052226
##  [506] -0.871522312 -1.128122543 -0.321467648 -0.994841691 -1.051658922
##  [511] -0.464049985 -1.704872262 -0.949375041 -0.642343932 -1.544616648
##  [516] -0.442174236 -1.100982600 -0.356945800 -1.046141391 -0.283838822
##  [521] -0.673766349 -2.116577368 -1.367310845 -0.887160852 -0.819879407
##  [526] -1.461135147 -1.104547461 -0.126167496 -0.617731921 -1.902299133
##  [531] -0.474745204 -0.902727119 -0.362225656 -0.461508879 -0.445254217
##  [536] -1.410186773 -0.654621345 -0.869378777 -2.155621744 -0.753671259
##  [541] -0.606373015 -0.213825074 -1.048053776 -1.315233511 -2.188637100
##  [546] -0.583609547 -0.473137825 -0.636550177  0.638187301 -0.635290479
##  [551] -1.269794755 -0.482773781 -0.795641258 -1.337367611 -0.225672082
##  [556] -0.590032810 -0.627454004 -0.998664461 -1.147389409 -1.830336969
##  [561] -0.202101660 -0.685766060 -1.789308950 -1.154617484 -0.240414001
##  [566] -0.846934026 -2.354627131 -1.236234534 -0.058376360 -1.506011790
##  [571] -0.387615074 -0.859455020 -0.929364774  0.674311283 -0.607975458
##  [576] -0.671281549 -0.764944713 -1.569039507 -0.440631720 -1.675721638
##  [581] -0.906954615 -0.836210218 -1.907588967 -0.726203793 -2.231803722
##  [586] -2.368078490 -1.721010988  0.098489890 -1.046482979 -0.585296529
##  [591] -0.522731379 -0.077319746 -1.413546088 -0.850929272 -0.242016041
##  [596] -0.239390016 -0.990775103 -1.497727638 -1.035315263 -1.152436838
##  [601] -0.880829532 -1.641161976 -1.421396370 -1.814828686 -1.407577639
##  [606] -1.580169913 -1.380584320 -0.990580622 -0.180806342 -2.220493657
##  [611] -0.955137330 -0.615346056 -1.163909784 -1.660507877 -1.289153488
##  [616] -1.829943143  0.241912654 -0.919784564 -1.070501316 -0.290612023
##  [621] -1.193571381 -0.251488927 -0.802880459 -1.360087576 -1.334555346
##  [626] -0.198975204 -2.144104435 -1.268100505 -1.411810888 -2.236208922
##  [631] -0.415568339 -0.605993870 -1.716685768 -1.299617140 -1.383499916
##  [636] -0.402690149 -0.929274440 -0.829385230 -1.299642182 -0.806214501
##  [641] -0.856034441 -0.907340057 -0.458623360 -1.379538500 -0.804893038
##  [646] -0.536433504 -1.148955705 -0.865695534 -0.936271885 -0.222020586
##  [651] -1.382367798 -0.409604785 -0.638685095 -0.815254419 -1.289546880
##  [656] -1.561824813 -1.372406466 -0.508460243 -1.237163041 -1.348539686
##  [661] -0.930139331 -0.516794295 -1.735316202 -1.499096231 -1.526551289
##  [666] -0.403265026 -1.580384154 -0.907609756 -2.602590349 -1.287190968
##  [671] -1.054205270 -1.311214045 -0.882883083 -0.444553338 -1.167562429
##  [676] -0.150842323 -1.618250136 -0.191387681 -0.296395713 -1.242144709
##  [681] -2.220280941 -0.891752763 -1.126535442 -0.747431311 -1.523081326
##  [686] -2.434372861 -1.270800430 -1.239377149 -2.344115475 -0.249093642
##  [691] -1.402675186 -2.187032587 -0.281744907 -0.012279278 -0.047159572
##  [696] -1.083929804 -1.605203081 -1.894245508 -1.404324089 -1.161005011
##  [701] -2.223618187 -2.349564961 -0.794435620 -0.298235638 -1.690470371
##  [706] -0.695452221 -0.888244711 -0.536282538 -1.359356402 -0.781122945
##  [711] -0.887259578 -0.140637192 -0.730419475 -1.586410534 -1.441571721
##  [716] -0.867699495 -1.881434569 -0.934111772 -0.269159586 -0.946604684
##  [721]  0.131355523 -0.442253940 -0.159777485 -0.167487785 -0.848918277
##  [726] -0.951416408 -1.743796111 -0.392686882 -1.442552010 -0.605746693
##  [731] -0.925484101 -0.416633014 -0.630759111 -0.430790424 -0.285826941
##  [736] -1.442026369 -0.813832104 -2.459149568 -1.547785026 -2.613497096
##  [741] -0.028643747 -1.313431089 -1.886549792 -0.535983022 -1.568504401
##  [746] -1.306181630 -1.308597130 -1.081574339 -1.376093330 -0.767190610
##  [751] -0.401269203 -1.894634390 -0.254296662 -0.942923439 -0.834848596
##  [756] -1.267468240 -2.180547635 -0.392721303 -1.063667393 -1.511859557
##  [761] -0.611937645 -0.679976192 -0.839341588 -1.851333317 -0.722281303
##  [766] -1.127265463 -1.153534643 -1.573723744 -0.792315479 -1.374307499
##  [771] -0.829529728 -0.391994496 -1.420114521 -0.795436272 -0.044009379
##  [776] -0.660238092 -1.609432702 -1.832345488 -1.728798890 -0.648399030
##  [781] -0.746085401 -1.344082660 -1.892914897 -2.035597744 -1.363871335
##  [786] -0.957070764 -1.846326431 -0.546511116 -1.879947978 -0.832991548
##  [791] -0.534662209  0.246687947 -1.149979297 -0.705242894 -1.094471870
##  [796] -2.469329192  0.454041253 -1.048389314 -0.928445427 -0.800959552
##  [801] -1.666472858 -0.541678867 -2.325250596 -0.637033870 -0.503190459
##  [806] -1.267731483 -0.855901273 -0.459624476 -1.671730200 -2.218638238
##  [811] -1.339163628 -0.372048156 -1.316640921 -0.935743122 -1.033940087
##  [816] -0.802348399 -1.917728129 -0.070398708 -0.842239197 -0.014817578
##  [821] -0.195021503 -0.652809018 -0.484103268 -1.078451037 -2.376728910
##  [826] -0.257143340 -0.427020999 -1.345793814 -0.933299929 -0.221384618
##  [831] -0.950722036 -2.193344419 -0.910194011 -0.017552213 -0.041148686
##  [836] -1.439960564 -0.045303480 -1.122365331 -1.073409040 -0.747623010
##  [841] -0.803239106 -1.292829121 -0.805740570 -1.138329789 -0.936502638
##  [846] -0.815831330  0.149549382 -0.767066258 -0.718844386 -0.640108914
##  [851] -2.117301366 -0.746553344 -0.568517044 -0.360820121 -1.622023643
##  [856] -0.537807685 -0.612000511 -0.461424672 -0.535475668 -1.066517015
##  [861] -0.686562280 -1.736247404 -0.807445172 -1.112802850 -1.444509484
##  [866] -1.790531313 -1.465751153 -1.716321699 -1.167933803 -0.827222613
##  [871] -0.707770164 -1.139026528 -1.157662057 -1.109218163 -1.770267344
##  [876] -0.205670853 -1.595533791 -0.975678093 -0.664045883 -0.803482417
##  [881] -1.144387874 -1.052186669 -0.579760126 -1.373008777 -0.798995256
##  [886] -1.172592957 -1.512486640 -0.988737662 -0.210217483 -0.834044986
##  [891] -0.442258356 -0.872724854 -0.560259417 -0.898358211 -1.796696694
##  [896] -0.223817010 -1.118307999 -0.859747959 -1.069345250 -1.082751117
##  [901] -0.792452587  0.103609505 -0.554566303 -0.605720333 -2.362049657
##  [906] -0.986530061 -0.936743435 -0.816096992 -1.042318413 -1.474477233
##  [911] -1.430635374 -0.302647167 -0.370385942 -0.638847838 -0.557971954
##  [916] -2.270174420 -0.860081667 -0.571333342 -0.768388365 -1.217804790
##  [921] -0.505009244 -1.701526008 -0.474236111 -1.774373413 -1.243359438
##  [926] -0.088939230 -1.608135029 -1.691110810 -1.113297090 -0.523289093
##  [931] -0.377266033 -1.442026369 -0.912061280 -0.493920367 -0.789406395
##  [936] -1.462637213 -2.583571748 -1.136791625 -1.825909688 -1.170002382
##  [941] -1.348246303 -1.731559975 -1.110742014 -0.784312646  0.138862503
##  [946] -1.881625653 -2.009195815 -0.250326663 -1.064105075 -1.740788138
##  [951] -0.975094355 -1.316773104 -1.837508916 -0.200960473 -1.363883713
##  [956] -1.372387803 -0.664823799 -2.487797357 -0.824094339 -1.873524206
##  [961] -2.334847026 -0.201783558 -0.291575791  0.133279128 -1.158120543
##  [966] -0.407343985  0.160385209 -0.466268162 -2.232620288 -1.385781251
##  [971] -0.283405733 -0.688488299 -2.239091776 -1.772524463 -1.131670696
##  [976] -1.648830994 -1.001261457 -1.360869524 -1.703386335 -1.783173775
##  [981] -0.394123760 -1.772057311 -0.364427350 -1.587992568 -0.802134748
##  [986]  0.357691689 -0.508238940 -0.646650771 -1.524612527 -0.323617168
##  [991] -0.282708500 -0.458069864 -0.911434736 -0.330591596 -1.351303320
##  [996] -1.073676059 -1.059394466 -1.375949730 -1.351798836 -1.154598926
## 
## $func.thetastar
## NULL
## 
## $jack.boot.val
## NULL
## 
## $jack.boot.se
## NULL
## 
## $call
## bootstrap(x = original.data, nboot = 1000, theta = skewness)</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="week-2-lab.html#cb160-1" tabindex="-1"></a><span class="fu">hist</span>(results,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;pink&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">freq=</span>F)</span>
<span id="cb160-2"><a href="week-2-lab.html#cb160-2" tabindex="-1"></a><span class="fu">hist</span>(results2<span class="sc">$</span>thetastar,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">border=</span><span class="st">&quot;purple&quot;</span>,<span class="at">add=</span>T,<span class="at">density=</span><span class="dv">20</span>,<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">freq=</span>F)</span></code></pre></div>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>What would have happened if we would have fit a normal distribution instead of a gamma distribution?</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="week-2-lab.html#cb161-1" tabindex="-1"></a>fit2<span class="ot">&lt;-</span><span class="fu">fitdistr</span>(original.data,dnorm,<span class="at">start=</span><span class="fu">list</span>(<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced

## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="week-2-lab.html#cb163-1" tabindex="-1"></a>fit2</span></code></pre></div>
<pre><code>##       mean          sd    
##   0.62820821   0.22881088 
##  (0.07235635) (0.05115997)</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="week-2-lab.html#cb165-1" tabindex="-1"></a>results.norm<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb165-2"><a href="week-2-lab.html#cb165-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb165-3"><a href="week-2-lab.html#cb165-3" tabindex="-1"></a>  {</span>
<span id="cb165-4"><a href="week-2-lab.html#cb165-4" tabindex="-1"></a>  x.star<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="fu">length</span>(original.data),<span class="at">mean=</span>fit2<span class="sc">$</span>estimate[<span class="dv">1</span>],<span class="at">sd=</span>fit2<span class="sc">$</span>estimate[<span class="dv">2</span>])</span>
<span id="cb165-5"><a href="week-2-lab.html#cb165-5" tabindex="-1"></a>  results.norm<span class="ot">&lt;-</span><span class="fu">c</span>(results.norm,<span class="fu">skewness</span>(x.star))</span>
<span id="cb165-6"><a href="week-2-lab.html#cb165-6" tabindex="-1"></a>  }</span>
<span id="cb165-7"><a href="week-2-lab.html#cb165-7" tabindex="-1"></a><span class="fu">head</span>(results.norm)</span></code></pre></div>
<pre><code>## [1] -0.597259338  0.004432921 -0.918726874 -0.357112190  0.175446565
## [6]  0.648364444</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="week-2-lab.html#cb167-1" tabindex="-1"></a><span class="fu">hist</span>(results,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;pink&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">freq=</span>F)</span>
<span id="cb167-2"><a href="week-2-lab.html#cb167-2" tabindex="-1"></a><span class="fu">hist</span>(results.norm,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">col=</span><span class="st">&quot;lightgreen&quot;</span>,<span class="at">freq=</span>F,<span class="at">add=</span>T)</span>
<span id="cb167-3"><a href="week-2-lab.html#cb167-3" tabindex="-1"></a><span class="fu">hist</span>(results2<span class="sc">$</span>thetastar,<span class="at">breaks=</span><span class="dv">30</span>,<span class="at">border=</span><span class="st">&quot;purple&quot;</span>,<span class="at">add=</span>T,<span class="at">density=</span><span class="dv">20</span>,<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">freq=</span>F)</span></code></pre></div>
<p><img src="Week-2-Lab_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>All three methods (two parametric and one non-parametric) really do give different distributions for the bootstrapped statistic, so the choice of which method is best depends a lot on the situation, how much data you have, and what you might already know about the underlying distribution.</p>
<p>Jackknifing is just as easy at bootstrapping. Here we will do a trivial example for illustration. We will write a little function for the mean even though you could put the function in directly with ‘jackknife(x,mean)’</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="week-2-lab.html#cb168-1" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="cf">function</span>(x)</span>
<span id="cb168-2"><a href="week-2-lab.html#cb168-2" tabindex="-1"></a>  {</span>
<span id="cb168-3"><a href="week-2-lab.html#cb168-3" tabindex="-1"></a>  <span class="fu">mean</span>(x)</span>
<span id="cb168-4"><a href="week-2-lab.html#cb168-4" tabindex="-1"></a>  }</span>
<span id="cb168-5"><a href="week-2-lab.html#cb168-5" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="at">by=</span><span class="dv">1</span>)</span>
<span id="cb168-6"><a href="week-2-lab.html#cb168-6" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">jackknife</span>(<span class="at">x=</span>x,<span class="at">theta=</span>theta)</span>
<span id="cb168-7"><a href="week-2-lab.html#cb168-7" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>## $jack.se
## [1] 0.9574271
## 
## $jack.bias
## [1] 0
## 
## $jack.values
##  [1] 5.000000 4.888889 4.777778 4.666667 4.555556 4.444444 4.333333 4.222222
##  [9] 4.111111 4.000000
## 
## $call
## jackknife(x = x, theta = theta)</code></pre>
<p><strong><span style="color: green;">Checkpoint #7: Why do we not have to tell the ‘jackknife’ function how many replicates to do?</span></strong></p>
<p>Let’s compare this with what we would have obtained from bootstrapping</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="week-2-lab.html#cb170-1" tabindex="-1"></a>results2<span class="ot">&lt;-</span><span class="fu">bootstrap</span>(x,<span class="dv">1000</span>,theta)</span>
<span id="cb170-2"><a href="week-2-lab.html#cb170-2" tabindex="-1"></a><span class="fu">mean</span>(results2<span class="sc">$</span>thetastar)<span class="sc">-</span><span class="fu">mean</span>(x)  <span class="co">#this is the bias</span></span></code></pre></div>
<pre><code>## [1] -0.015</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="week-2-lab.html#cb172-1" tabindex="-1"></a><span class="fu">sd</span>(results2<span class="sc">$</span>thetastar)  <span class="co">#the standard deviation of the theta stars is the SE of the statistic (in this case, the mean)</span></span></code></pre></div>
<pre><code>## [1] 0.9057458</code></pre>
<p>Everything we have done to this point used the R package ‘bootstrap’ - now lets compare that with the R package ‘boot’. To avoid any confusion (a.k.a. masking) between the two packages, I recommend detaching the bootstrap package from the workspace with</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="week-2-lab.html#cb174-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:bootstrap&quot;</span>)</span></code></pre></div>
<p>The ‘boot’ package is now recommended over the ‘bootstrap’ package, but they give the same answers and to some extent it is personal preference which one prefers to use.</p>
<p>We will still use the mean as the statistic of interest, but we will have to write a new function for it because the syntax of the ‘boot’ package is slightly different:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="week-2-lab.html#cb175-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb175-2"><a href="week-2-lab.html#cb175-2" tabindex="-1"></a>theta<span class="ot">&lt;-</span><span class="cf">function</span>(x,index)</span>
<span id="cb175-3"><a href="week-2-lab.html#cb175-3" tabindex="-1"></a>  {</span>
<span id="cb175-4"><a href="week-2-lab.html#cb175-4" tabindex="-1"></a>  <span class="fu">mean</span>(x[index])</span>
<span id="cb175-5"><a href="week-2-lab.html#cb175-5" tabindex="-1"></a>  }</span>
<span id="cb175-6"><a href="week-2-lab.html#cb175-6" tabindex="-1"></a><span class="fu">boot</span>(x,theta,<span class="at">R=</span><span class="dv">999</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = theta, R = 999)
## 
## 
## Bootstrap Statistics :
##     original      bias    std. error
## t1*      4.5 -0.01661662   0.8957952</code></pre>
<p>One of the main advantages to the ‘boot’ package over the ‘bootstrap’ package is the nicer formatting of the output.</p>
<p>Going back to our original code, lets see how we could reproduce all of these numbers:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="week-2-lab.html#cb177-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sample</span>(x,<span class="at">size=</span><span class="fu">length</span>(x),<span class="at">replace=</span>T))</span></code></pre></div>
<pre><code>## 
## 0 2 3 4 6 7 
## 3 1 1 2 1 2</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="week-2-lab.html#cb179-1" tabindex="-1"></a>xmeans<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb179-2"><a href="week-2-lab.html#cb179-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>)</span>
<span id="cb179-3"><a href="week-2-lab.html#cb179-3" tabindex="-1"></a>  {</span>
<span id="cb179-4"><a href="week-2-lab.html#cb179-4" tabindex="-1"></a>  xmeans[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">sample</span>(x,<span class="at">replace=</span>T))</span>
<span id="cb179-5"><a href="week-2-lab.html#cb179-5" tabindex="-1"></a>  }</span>
<span id="cb179-6"><a href="week-2-lab.html#cb179-6" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 4.5</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="week-2-lab.html#cb181-1" tabindex="-1"></a>bias<span class="ot">&lt;-</span><span class="fu">mean</span>(xmeans)<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb181-2"><a href="week-2-lab.html#cb181-2" tabindex="-1"></a>se.boot<span class="ot">&lt;-</span><span class="fu">sd</span>(xmeans)</span>
<span id="cb181-3"><a href="week-2-lab.html#cb181-3" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] -0.0541</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="week-2-lab.html#cb183-1" tabindex="-1"></a>se.boot</span></code></pre></div>
<pre><code>## [1] 0.8940148</code></pre>
<p>Why do our numbers not agree exactly with those of the boot package? This is because our estimates of bias and standard error are just estimates, and they carry with them their own uncertainties. That is one of the reasons we might bother doing jackknife-after-bootstrap.</p>
<p>The ‘boot’ package has a LOT of functionality. If we have time, we will come back to some of these more complex functions later in the semester as we cover topics like regression and glm.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-2-lecture.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-3-lecture.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
